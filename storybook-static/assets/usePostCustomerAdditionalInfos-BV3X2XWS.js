import{l as z,m as L,R as k,u as M}from"./main-BbuvrTKi.js";import{u as B}from"./useQuery-DDRZMcvI.js";import{a as I,A as U,u as F,g as Q}from"./AxiosInstance-BZZbXQ8a.js";import{O as r,S as f,b as G}from"./formik.esm-DgjVmEdT.js";import{e as H,r as K,p as J,a as W,b as X,c as Y}from"./index-D1YCTWBN.js";import{j as o,b as m}from"./index-BzhTyqaY.js";import{r as c}from"./index-0X8QCd_i.js";import{M as j}from"./index-E8Xemi00.js";import{A as Z,a as ee,d as se}from"./index-CenKVISr.js";import{u as ae}from"./useInterweave-MFQvh887.js";import{u as oe}from"./useTranslation-BYGhmYBG.js";import{u as te}from"./useMutation-DnofRurj.js";function be(t,e=""){const a=e||"?services[]=efacture&services[]=alerte_fuite&services[]=alerte_conso&services[]=smartcoach";return B("getServicesStatus",()=>I.get(U.SERVICES.STATUS+encodeURI(a)),t||{})}const Se=r({email:H,repeated_email:K()}),Ne=r({old_password:f().required("mandatory_field"),password:J,repeated_password:W("password")}),ge=r({contract_name:f().max(30,"personalInfos.form.contract.error").required("mandatory_field")}),xe=r({mobile_phone:X.required("mandatory_field")}),Ce=r({phone:Y.required("mandatory_field")}),D={peopleCount:f().required("mandatory_field"),housingType:f().required("mandatory_field")},_e=r({...D}),Ee=r({...D,consentGiven:G().oneOf([!0],"mandatory_field").required("mandatory_field")}),je=({sourceType:t="infoPerso",type:e,updatedValue:i,success:a,context:n,toRedirect:d=Q(k.ACCOUNT_PERSONAL_INFORMATIONS),trackingSuccess:S,trackingError:N,onHideCloseModal:u,setShowModal:g})=>{const{t:s}=oe(),{transform:x}=ae(),p=F(),[l,A]=c.useState(5);c.useEffect(()=>{if(u){u(!0);let _=setInterval(()=>{A(E=>E<=1?(clearInterval(_),0):E-1)},1e3);return()=>clearInterval(_)}},[u,p,d]),c.useEffect(()=>{l<=1&&p.push(d)},[l]),c.useEffect(()=>{a&&S&&S(),!a&&N&&N()},[e,i,a]);const P=t==="histoConso"?s(`histoConso.${e}.technical_error.title`):s("personalInfos.form.technical_error.title",{date:z,time:L}),h=e==="phone"||e==="mobilePhone",T=s(`personalInfos.form.${e}.validation.title`,{context:n});let v=s(`personalInfos.form.${e}.title`,{context:n});switch(t){case"histoConso":v=s(`histoConso.${e}.title`);break;case"infoPerso":h&&(v=T);break}const O=t==="histoConso"?s(`histoConso.${e}.technical_error.description`):e==="on-connect-desactivation"?s("personalInfos.form.on-connect-desactivation.technical_error"):s("personalInfos.form.technical_error.description",{field:s(`personalInfos.form.${e}.technical_error`),context:e==="e-facture"?"efacture":""}),$=s(`personalInfos.form.${e}.validation.body`,{context:n});let w=s(`personalInfos.form.${e}.validated`);switch(t){case"histoConso":w=s(`histoConso.${e}.validated`,{countdown:l,plural:l>1?"s":""});break;case"infoPerso":h&&(w=$);break}const V=s(`personalInfos.form.${e}.validation.updated`,{updatedValue:i}),R=s(`personalInfos.form.${e}.updated`,{updatedValue:i}),C=()=>{d&&p.push(d),g&&g(!1)},q=a?ee:se,b=["password","on-connect","on-connect-desactivation"],y=a&&!(b!=null&&b.includes(e))&&n!=="erase_ok";return o.jsxDEV(o.Fragment,{children:[o.jsxDEV(m.SzTypographie,{variant:"H3",size:"L",weight:"medium",children:a?v:P},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/UpdateStatus.tsx",lineNumber:150,columnNumber:7},void 0),o.jsxDEV(Z,{className:"my-3 my-lg-4",variant:q,children:o.jsxDEV(m.SzTypographie,{variant:"body",size:"M",weight:"regular",tag:"span",children:o.jsxDEV(j,{content:a?w:O,transform:x},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/UpdateStatus.tsx",lineNumber:155,columnNumber:11},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/UpdateStatus.tsx",lineNumber:154,columnNumber:9},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/UpdateStatus.tsx",lineNumber:153,columnNumber:7},void 0),y&&o.jsxDEV(m.SzTypographie,{variant:"body",size:"L",weight:"regular",tag:"span",children:o.jsxDEV(j,{content:h?V:R,transform:x},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/UpdateStatus.tsx",lineNumber:163,columnNumber:11},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/UpdateStatus.tsx",lineNumber:162,columnNumber:9},void 0),t==="histoConso"&&u?l===0?o.jsxDEV("div",{className:"text-lg-right mt-4 mt-lg-5",children:o.jsxDEV(m.SzButton,{variant:"contained",border:"soft",type:"button",id:"close-btn",onClick:C,children:s("histoConso.on-connect.continue")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/UpdateStatus.tsx",lineNumber:172,columnNumber:13},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/UpdateStatus.tsx",lineNumber:171,columnNumber:11},void 0):null:o.jsxDEV("div",{className:"text-lg-right mt-4 mt-lg-5",children:o.jsxDEV(m.SzButton,{variant:"contained",border:"soft",type:"button",id:"close-btn",onClick:C,children:s("close")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/UpdateStatus.tsx",lineNumber:185,columnNumber:11},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/UpdateStatus.tsx",lineNumber:184,columnNumber:9},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/UpdateStatus.tsx",lineNumber:149,columnNumber:5},void 0)};function Ie(t){const e=M(),i=a=>I.post(U.SMARTCOACH.CUSTOMER_ADDITIONAL_INFOS,a);return te(async a=>{const n=await i(a);return e.setQueryData([t],n),n})}export{je as U,_e as a,be as b,Se as c,Ne as d,ge as e,xe as f,Ce as g,Ee as o,Ie as u};
