import{j as e,b as a}from"./index-BzhTyqaY.js";import{r as A}from"./index-0X8QCd_i.js";import{d as $,T as V,L as _}from"./react-spring-web.esm-DsMzZgQq.js";import{F as ee}from"./index-BsXj3zEC.js";import{u as ne,U as oe,o as se,a as ae}from"./usePostCustomerAdditionalInfos-BV3X2XWS.js";import{F as x}from"./FormError-BtpZASc0.js";import{F as te}from"./formik.esm-DgjVmEdT.js";import{R as d}from"./main-BbuvrTKi.js";import{u as ie}from"./useMutation-DnofRurj.js";import{u as le,g as f,a as re,A as ce,b as ue}from"./AxiosInstance-BZZbXQ8a.js";import"./index-m5SwaE3w.js";/* empty css              *//* empty css                         */import{u as me}from"./useTranslation-BYGhmYBG.js";function de({shouldRedirect:p,withToken:o}){const C=le();return ie("GetCustomerAdditionalInfos",()=>re.get(ce.SMARTCOACH.CUSTOMER_ADDITIONAL_INFOS,{params:{token:o??!1}}),{onSettled:(n,N)=>{var l;const s=((l=n==null?void 0:n.data)==null?void 0:l.content)||{},i=!!N,r=f(d.ACCOUNT_PERSONAL_INFORMATIONS,{modal:"on-connect"});p&&C.push(r,{isErrorAddInfo:i,...s})}})}const Se=({handleClose:p,source:o="infoPerso",onHideCloseModal:C})=>{var y,S,T;const{t:n}=me(),{track:N}=$(),s="histoConso",{privacy_policy:i}=(S=(y=window.tsme_data)==null?void 0:y.footer)==null?void 0:S.links_bottom,{state:r}=ue(),{mutate:l,data:b,isError:R,isSuccess:P}=de({shouldRedirect:!1,withToken:!0});A.useEffect(()=>{!r&&o!==s&&l()},[]);const{peopleCount:h,consentGiven:k,housingType:G,isErrorAddInfo:z}=r||{...((T=b==null?void 0:b.data)==null?void 0:T.content)||{},isErrorAddInfo:R},U={infoPerso:"postSmartCoachAddInfoInfoPerso",histoConso:"postSmartCoachAddInfoHistoConso"},{mutate:L,isLoading:O,isError:M,isSuccess:c}=ne(U[o]),{isIntranet:j}=window.tsme_data,F={label:n("save"),align:"right",loader:O,disabled:j||O},H={enabled:!0,label:n("cancel"),align:"left",onClick:p},B=t=>{N("PERSONAL_INFO_7");const v={...t,useCommunityHotWater:"1"};L(v)},K={peopleCount:h||"",housingType:G,consentGiven:k},E=[{label:"1",value:"1"},{label:"2",value:"2"},{label:"3",value:"3"},{label:"4",value:"4"},{label:"5",value:"5"},{label:"6",value:"6"},{label:"7",value:"7"},{label:"8",value:"8"},{label:"9",value:"9"},{label:"10+",value:"10+"}],q=h?E.find(({value:t})=>t===h):{};if(A.useEffect(()=>{c&&o===s&&l({token:!0})},[c]),c||M||z){const t=o===s?f(d.ACCOUNT_CONSUMPTION_TR):f(d.ACCOUNT_PERSONAL_INFORMATIONS);return e.jsxDEV(oe,{type:"on-connect",sourceType:o===s?s:"infoPerso",success:c,toRedirect:t,onHideCloseModal:C},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:135,columnNumber:7},void 0)}const W=n(o===s?"histoConso.on-connect.title":"personalInfos.form.on-connect.title"),J=o===s,Q=o!==s,X=f(d.ACCOUNT_PERSONAL_INFORMATIONS,{modal:"on-connect-desactivation"}),Y=o===s?se:ae;return e.jsxDEV("div",{children:[e.jsxDEV(a.SzTypographie,{variant:"H3",size:"L",weight:"medium",children:W},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:168,columnNumber:7},void 0),e.jsxDEV(te,{initialValues:K,validateOnBlur:!1,validateOnChange:!0,validationSchema:Y,onSubmit:B,enableReinitialize:!0,children:({handleSubmit:t,handleChange:v,setFieldValue:D,values:u,errors:m,touched:w})=>{const I=g=>{D("housingType",g.target.value)},Z=g=>{D("peopleCount",g.label)};return e.jsxDEV("form",{id:"onConnectCoach",onSubmit:t,className:"on-connect-coach-form",children:[e.jsxDEV("div",{className:"col-12 col-lg-7 px-0 my-4",children:[e.jsxDEV("div",{className:"mb-3",children:[e.jsxDEV(a.SzTypographie,{className:"mb-2",children:n("personalInfos.form.on-connect.people_count_label")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:207,columnNumber:19},void 0),e.jsxDEV(a.SzSelect,{name:"peopleCount",id:"peopleCount",placeholder:n("personalInfos.form.on-connect.people_count_placeholder"),defaultValue:q,options:E,value:u.peopleCount||"",onChange:Z,className:"mb-2"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:210,columnNumber:19},void 0),e.jsxDEV(x,{field:"peopleCount",customDisplay:w.peopleCount&&m.peopleCount},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:222,columnNumber:19},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:206,columnNumber:17},void 0),e.jsxDEV("div",{className:"mb-3",children:[e.jsxDEV(a.SzTypographie,{className:"mb-2",children:n("personalInfos.form.on-connect.housing_type")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:228,columnNumber:19},void 0),e.jsxDEV("div",{className:"d-flex mb-2",children:[e.jsxDEV(a.SzRadio,{id:"housingTypeHouse",name:"housingType",label:n("personalInfos.form.on-connect.type_house"),value:"M",checked:u.housingType==="M",onChange:I},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:232,columnNumber:21},void 0),e.jsxDEV(a.SzRadio,{className:"ml-3",id:"housingTypeApartment",name:"housingType",label:n("personalInfos.form.on-connect.type_apartment"),value:"A",checked:u.housingType==="A",onChange:I},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:240,columnNumber:21},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:231,columnNumber:19},void 0),e.jsxDEV(x,{field:"housingType",customDisplay:w.housingType&&m.housingType},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:250,columnNumber:19},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:227,columnNumber:17},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:205,columnNumber:15},void 0),o===s&&e.jsxDEV("div",{className:"col-12 mt-3 px-0 border-top border-1 border-gray-100 pt-3",children:[e.jsxDEV(a.SzCheckbox,{id:"consentGiven",name:"consentGiven",label:n("personalInfos.form.on-connect.consent"),type:"checkbox",checked:u.consentGiven||!1,onChange:v},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:258,columnNumber:19},void 0),m.consentGiven&&w.consentGiven?e.jsxDEV("div",{"data-cy":"error-consentGiven",role:"alert",children:e.jsxDEV(a.SzTypographie,{variant:"caption",color:"danger",className:"mb-2",children:n(m.consentGiven)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:268,columnNumber:23},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:267,columnNumber:21},void 0):e.jsxDEV(x,{field:"consentGiven"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:277,columnNumber:21},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:257,columnNumber:17},void 0),Q&&e.jsxDEV("div",{className:"col-12 mt-3 px-0 border-top border-1 border-gray-100 pt-3",children:e.jsxDEV(a.SzTypographie,{variant:"caption",weight:"regular",size:"M",children:e.jsxDEV(V,{i18nKey:"personalInfos.form.on-connect.unsubscribe.link",components:{redirect:e.jsxDEV(_,{id:"on-connect-unusubscribe-btn",decorate:!0,to:X},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:288,columnNumber:27},void 0)}},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:284,columnNumber:21},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:283,columnNumber:19},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:282,columnNumber:17},void 0),J&&e.jsxDEV(a.SzTypographie,{variant:"caption",weight:"regular",size:"M",className:"mt-3",children:e.jsxDEV(V,{i18nKey:"loginReset.login.step4.form.mobilePhone.privacy_policy",components:{redirect:e.jsxDEV(_,{className:"font-family-medium",decorate:!0,target:"_blank",to:i==null?void 0:i.link},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:312,columnNumber:25},void 0)}},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:306,columnNumber:19},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:300,columnNumber:17},void 0),e.jsxDEV(ee,{previous:H,next:F},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:324,columnNumber:15},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:200,columnNumber:13},void 0)}},P?"reloadOnConnectCoach":"OnConnectCoach",!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:172,columnNumber:7},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:167,columnNumber:5},void 0)};export{Se as O,de as u};
