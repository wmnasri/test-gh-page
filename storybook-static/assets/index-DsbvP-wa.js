import{j as e,b as a,a as Y}from"./index-BzhTyqaY.js";import{d as X,T as xe,L as ye,c as ue,C as Ee,v as je}from"./react-spring-web.esm-DsMzZgQq.js";import{u as J}from"./useResponsive-DQBhMvnf.js";import{r as P}from"./index-0X8QCd_i.js";import{R as p,l as Ie,m as Ce,f as le,ah as ve,ai as Ve}from"./main-BbuvrTKi.js";import{u as De}from"./useInterweave-MFQvh887.js";import{M as ce}from"./index-E8Xemi00.js";import{O as Me,b as Te,F as Se}from"./formik.esm-DgjVmEdT.js";import{F as _e}from"./index-BsXj3zEC.js";import{A as re}from"./index-CenKVISr.js";import{S as O}from"./index-R4VhrMC6.js";import{u as we,P as Oe,M as Fe,a as Le}from"./index-C14TNAKt.js";import{u as he}from"./useMutation-DnofRurj.js";import{u as me,g as C,a as k,A as H,c as Pe,b as de}from"./AxiosInstance-BZZbXQ8a.js";import{F as ke}from"./FormError-BtpZASc0.js";import{u as fe}from"./useQueryObserver-BYynaL_B.js";import"./index-m5SwaE3w.js";/* empty css              *//* empty css                         */import{u as F}from"./useTranslation-BYGhmYBG.js";import{u as Z}from"./useQuery-DDRZMcvI.js";import{P as be}from"./index-Db1AUTVa.js";import{u as He}from"./useSearchParams-D6beRwI4.js";import{p as Ne}from"./index-Q2QYDiWy.js";import{u as ze}from"./useToRedirect-BsmConZ5.js";import{B as Ae,M as Be}from"./index-BtPFRhf6.js";import{S as Ue}from"./index-Cacbe8Qg.js";import"./index-BoI371yk.js";import"./index-4p5aklhB.js";import"./throttle-C5YRRb_b.js";import"./_baseIsEqual-DwR-aJgz.js";import"./recaptcha-wrapper-CLWKokWK.js";import"./nonIterableRest-CnCppAvF.js";import"./iframe-CrganuSH.js";import"../sb-preview/runtime.js";import"./cross-circle-D-gJHWvz.js";import"./index-D593oKY2.js";import"./PhoneInput-CWQsNAcr.js";import"./index-CTjy3iMP.js";import"./index-D1YCTWBN.js";import"./index-2r8MWarU.js";import"./PaymentChoice-B26KIjmU.js";import"./index-DNT32797.js";import"./ContractSummary-C2MvU0wS.js";import"./emotion-css.esm-Clv7IYTo.js";import"./useIsFetching-B7nv8BYd.js";import"./alert-CQfNZT_D.js";import"./useSetOtp-CzAWukMa.js";import"./Tips-j9k3pi84.js";import"./light-bulb-shine-BN5xHApG.js";import"./InputSeries-CZppcBLq.js";import"./index-CrOxkS7a.js";import"./createWithBsPrefix--uDGuUX5.js";import"./divWithClassName-BF71WaKi.js";import"./OnConnectCoachContent-CZWjTvpl.js";import"./usePostCustomerAdditionalInfos-BV3X2XWS.js";import"./useWaitForDOMRef-BJ73eCtx.js";import"./index-Cj_2uQx9.js";import"./useScrollTo-VXXfg99K.js";import"./check-circle-1-CH6VNuLl.js";import"./index-BBUdod_g.js";import"./index-B4MErowZ.js";import"./add-circle-56pf8-2t.js";const Re=""+new URL("invoices-explain-DSCrodL9.png",import.meta.url).href,Ye=Me({consent:Te().oneOf([!0],"mandatory_field")}),Ge=({closeModal:n})=>{var z,A;const{t:i}=F(),{transform:o}=De(),c=me(),{modeListPaymentData:r,isLoading:m,isError:t}=we(),{refetch:d}=fe("GetDataPushService"),[l,s]=P.useState(!1),{footer:N}=window.tsme_data,h=(A=(z=N==null?void 0:N.links_bottom)==null?void 0:z.credits_url)==null?void 0:A.link,{currentPaymentModeCode:u}=r||{},f=["M","P"].includes(u??""),{track:x}=X(),{isError:y,error:v,reset:V,isLoading:D,isSuccess:g,...I}=he(()=>k.post(H.PAYMENT.POST_PAYMENT_E_INVOICE),{onSuccess:()=>{d(),c.push(C(p.ACCOUNT_INVOICES,{modal:"modale-e-facture",status:"confirmation"}))},onError:()=>{c.push(C(p.ACCOUNT_INVOICES,{modal:"modale-e-facture",status:"erreur"}))}}),L={label:i("invoiceHistory.EFactureModal.button",{context:f?"subscribe":"redirect"}),align:"right",loader:l||D},M={consent:!1},ee=()=>{f?(x("INVOICE_CONSULTATION_3",{etat_prelevement_auto:"prelevement_auto_ok"}),I.mutate()):(x("INVOICE_CONSULTATION_3",{etat_prelevement_auto:"prelevement_auto_pas_ok"}),s(!0),c.push(p.PAYMENT.MY_PAYMENT_METHOD_EFACTURE))};return m?e.jsxDEV("div",{children:[e.jsxDEV(O,{count:1,width:"50%",height:28,className:"mb-2"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:107,columnNumber:9},void 0),e.jsxDEV(O,{count:1,width:"100%",height:300},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:108,columnNumber:9},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:106,columnNumber:7},void 0):y||t?e.jsxDEV(e.Fragment,{children:[e.jsxDEV(a.SzTypographie,{variant:"H3",weight:"medium",size:"L",children:i("invoiceHistory.EFactureModal.technical_error.title",{date:Ie,time:Ce})},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:116,columnNumber:9},void 0),e.jsxDEV(re,{variant:"alert",className:"my-3 my-lg-4",children:e.jsxDEV(a.SzTypographie,{variant:"body",size:"M",weight:"regular",tag:"span",children:i("invoiceHistory.EFactureModal.technical_error.description",{context:y?"subscribe":"init"})},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:123,columnNumber:11},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:122,columnNumber:9},void 0),e.jsxDEV("div",{className:"text-lg-right mt-4 mt-lg-5",children:e.jsxDEV(a.SzButton,{variant:"contained",border:"soft",type:"button",onClick:n,"data-cy":"close-e-facture-modal",children:i("close")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:130,columnNumber:11},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:129,columnNumber:9},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:115,columnNumber:7},void 0):g?e.jsxDEV(e.Fragment,{children:[e.jsxDEV(a.SzTypographie,{variant:"H3",weight:"medium",size:"L",children:i("invoiceHistory.EFactureModal.title")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:147,columnNumber:9},void 0),e.jsxDEV(re,{variant:"success",className:"my-3 my-lg-4",children:e.jsxDEV(a.SzTypographie,{variant:"body",size:"M",weight:"regular",tag:"span",children:i("invoiceHistory.EFactureModal.confirmation")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:151,columnNumber:11},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:150,columnNumber:9},void 0),e.jsxDEV("div",{className:"text-lg-right mt-4 mt-lg-5",children:e.jsxDEV(a.SzButton,{variant:"contained",border:"soft",type:"button","data-cy":"close-e-facture-modal",onClick:n,children:i("close")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:156,columnNumber:11},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:155,columnNumber:9},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:146,columnNumber:7},void 0):e.jsxDEV(e.Fragment,{children:[e.jsxDEV(a.SzTypographie,{variant:"H3",weight:"medium",size:"L",children:i("invoiceHistory.EFactureModal.title")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:172,columnNumber:7},void 0),e.jsxDEV(a.SzTypographie,{variant:"body",size:"L",weight:"regular",className:"text-dark",children:e.jsxDEV(ce,{content:i("invoiceHistory.EFactureModal.description"),transform:o},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:181,columnNumber:9},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:175,columnNumber:7},void 0),!f&&e.jsxDEV(re,{variant:"info",children:e.jsxDEV(ce,{content:i("invoiceHistory.EFactureModal.info"),transform:o},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:188,columnNumber:11},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:187,columnNumber:9},void 0),e.jsxDEV(Se,{initialValues:M,validateOnBlur:!1,validateOnChange:!0,validationSchema:Ye,onSubmit:ee,children:({handleSubmit:B,values:U,setFieldValue:R,errors:T})=>e.jsxDEV("form",{id:"e-facture-subscribe",onSubmit:B,children:[e.jsxDEV("div",{className:"col-12 mt-4 px-0 pt-3 border-top border-1 border-gray-100",children:[e.jsxDEV(a.SzCheckbox,{id:"consent",name:"consent",label:e.jsxDEV(a.SzTypographie,{variant:"body",weight:"regular",className:"text-dark",children:e.jsxDEV(xe,{i18nKey:"invoiceHistory.EFactureModal.CGU",components:{redirect:e.jsxDEV(ye,{decorate:!0,to:h,className:"text-dark"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:218,columnNumber:29},void 0)}},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:214,columnNumber:23},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:209,columnNumber:21},void 0),type:"checkbox",checked:U.consent,onChange:G=>{R("consent",G.target.checked,!0)}},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:205,columnNumber:17},void 0),e.jsxDEV(ke,{field:"consent",customDisplay:T.consent},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:234,columnNumber:17},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:204,columnNumber:15},void 0),e.jsxDEV(_e,{next:L},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:236,columnNumber:15},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:203,columnNumber:13},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:194,columnNumber:7},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/invoice-history/EFactureModalContent.tsx",lineNumber:171,columnNumber:5},void 0)},We=({date:n,type:i,amount:o})=>{const{t:c}=F();return e.jsxDEV("div",{className:"bg-gray-200 rounded-2 p-3 px-lg-4 py-lg-3",children:[e.jsxDEV(a.SzTypographie,{variant:"body",weight:"bold",className:"text-blue-electric mb-0",tag:"span",children:n},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/DownloadInvoiceModalContent.tsx",lineNumber:25,columnNumber:7},void 0),e.jsxDEV(a.SzTypographie,{variant:"H2",size:"XL",weight:"bold",className:"mb-2",children:c("invoiceHistory.invoiceList.modal.amount",{amount:o})},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/DownloadInvoiceModalContent.tsx",lineNumber:33,columnNumber:7},void 0),e.jsxDEV(a.SzTypographie,{variant:"body",weight:"regular",className:"text-dark mb-0",children:i},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/DownloadInvoiceModalContent.tsx",lineNumber:36,columnNumber:7},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/invoice-history/DownloadInvoiceModalContent.tsx",lineNumber:24,columnNumber:5},void 0)},Qe=({insert:n,invoiceNumber:i,invoiceAmount:o,invoiceType:c,invoiceDate:r,push:m})=>{const{t}=F(),{track:d}=X(),l=J(),[s,N]=P.useState(!1),h=Y("col-12 col-lg-8 mt-4 mt-lg-0 ml-0 ml-lg-4 pt-4 pt-lg-0 px-0 pl-lg-4 d-flex flex-column align-items-start border-1 border-gray-100",{"border-top":l,"border-left":!l}),u=Y("push-item overflow-hidden d-flex bg-white rounded-2 cursor-pointer mb-4"),f=()=>{N(!0),d("INVOICE_CONSULTATION_1",{nature_facture:c});const x=C(p.ACCOUNT_INVOICES_INVOICE_VIEW,{invoice:i??""});window.open(x,"_blank"),N(!1)};return e.jsxDEV(e.Fragment,{children:[e.jsxDEV(a.SzTypographie,{variant:"H3",weight:"medium",size:"L",className:"mb-4",children:t("invoiceHistory.invoiceList.modal.title")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/DownloadInvoiceModalContent.tsx",lineNumber:83,columnNumber:7},void 0),e.jsxDEV("div",{className:"d-flex flex-column flex-lg-row",children:[e.jsxDEV("div",{className:"col-12 col-lg-4 px-0",children:[e.jsxDEV(We,{amount:o,type:c,date:r},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/DownloadInvoiceModalContent.tsx",lineNumber:88,columnNumber:11},void 0),e.jsxDEV(a.SzButton,{variant:"contained",icon:"download-bottom",alignIcon:"right",border:"soft",className:"mt-3",onClick:f,loader:s,"data-cy":"download-invoice",children:t("invoiceHistory.invoiceList.modal.downloadBtn")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/DownloadInvoiceModalContent.tsx",lineNumber:93,columnNumber:11},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/invoice-history/DownloadInvoiceModalContent.tsx",lineNumber:87,columnNumber:9},void 0),(n||m)&&e.jsxDEV("div",{className:h,children:[m&&e.jsxDEV(be,{data:m,style:u},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/DownloadInvoiceModalContent.tsx",lineNumber:108,columnNumber:22},void 0),n&&e.jsxDEV(e.Fragment,{children:[e.jsxDEV("div",{className:"d-flex align-items-center",children:[e.jsxDEV(a.SzIcon,{icon:"attachment",variant:"bold"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/DownloadInvoiceModalContent.tsx",lineNumber:112,columnNumber:19},void 0),e.jsxDEV(a.SzTypographie,{variant:"H5",size:"L",weight:"bold",className:"text-uppercase mb-0 ml-2",children:t("invoiceHistory.invoiceList.modal.attachments")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/DownloadInvoiceModalContent.tsx",lineNumber:113,columnNumber:19},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/invoice-history/DownloadInvoiceModalContent.tsx",lineNumber:111,columnNumber:17},void 0),n.map((x,y)=>e.jsxDEV($e,{invoiceNumber:i,data:x},y,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/DownloadInvoiceModalContent.tsx",lineNumber:123,columnNumber:19},void 0))]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/invoice-history/DownloadInvoiceModalContent.tsx",lineNumber:110,columnNumber:15},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/invoice-history/DownloadInvoiceModalContent.tsx",lineNumber:107,columnNumber:11},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/invoice-history/DownloadInvoiceModalContent.tsx",lineNumber:86,columnNumber:7},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/invoice-history/DownloadInvoiceModalContent.tsx",lineNumber:82,columnNumber:5},void 0)},$e=({invoiceNumber:n,data:i})=>{const{lbEncart:o,urlEncart:c}=i,r=C(p.ACCOUNT_INVOICES_ENCART_VIEW,{invoice:n??"",insert:c});return e.jsxDEV(ue,{variant:"text",to:r,target:"_blank","data-cy":"insert-item",children:e.jsxDEV(a.SzTypographie,{variant:"caption",size:"M",weight:"regular",className:"mb-0",children:o},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/DownloadInvoiceModalContent.tsx",lineNumber:148,columnNumber:7},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/DownloadInvoiceModalContent.tsx",lineNumber:147,columnNumber:5},void 0)};function qe(){return function({path:i,params:o,queryParams:c}){const r=C(i,o),m=new URLSearchParams(c);return`${r}?${m.toString()}`}}const Ke=({style:n,data:i,handleClick:o,loading:c})=>{const r=J(),{t:m,i18n:t}=F(),{dateFacture:d,motifFacturation:l,montantFacture:s}=i,h=t.exists(`invoiceHistory.invoiceLabels.${l}`)?m(`invoiceHistory.invoiceLabels.${l}`):"";return e.jsxDEV("div",{className:n,"data-cy":"invoice-list-item",children:[r?e.jsxDEV(a.SzTypographie,{weight:"regular",className:"text-dark mb-1 mb-lg-0",children:[d," - ",h]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceTable.tsx",lineNumber:52,columnNumber:9},void 0):e.jsxDEV(e.Fragment,{children:[e.jsxDEV(a.SzTypographie,{weight:"regular",className:"text-dark mb-0",children:d},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceTable.tsx",lineNumber:57,columnNumber:11},void 0),e.jsxDEV(a.SzTypographie,{weight:"regular",className:"text-dark mb-0",children:h},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceTable.tsx",lineNumber:60,columnNumber:11},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceTable.tsx",lineNumber:56,columnNumber:9},void 0),e.jsxDEV(a.SzTypographie,{weight:"bold",className:"mb-0",children:[s," €"]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceTable.tsx",lineNumber:65,columnNumber:7},void 0),e.jsxDEV(ue,{"data-cy":"invoice-dl-btn",variant:"text",className:"px-0",icon:"download-bottom",alignIcon:"right",onClick:()=>o(i),loader:c,children:m("download")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceTable.tsx",lineNumber:68,columnNumber:7},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceTable.tsx",lineNumber:50,columnNumber:5},void 0)},Xe=({invoiceData:n,currentPage:i,itemsPerPage:o,handlePageChange:c})=>{var $,q,E,S;const{t:r,i18n:m}=F(),t=me(),{modal:d}=Pe(),l=qe(),N=He().get("facture"),{track:h}=X(),u=n.findIndex(w=>w.numeroFacture===N),[f,x]=P.useState(u),y={numeroFacture:null,montantFacture:null,motifFacturation:null,dateFacture:null},v=f>-1?n[f]:y,V=Math.ceil(n.length/o),D=Math.max(1,Math.min(i,V)),g=(D-1)*o,I=Math.min(g+o,n.length),L=f%o,{data:M}=fe("GetDataPushHorizontal"),z=(((q=($=M==null?void 0:M.data)==null?void 0:$.content)==null?void 0:q.dataPush)||[]).find(w=>w.push_modale),B=m.exists(`invoiceHistory.invoiceLabels.${v==null?void 0:v.motifFacturation}`)?r(`invoiceHistory.invoiceLabels.${v==null?void 0:v.motifFacturation}`):"",U=w=>{c(w)},R=()=>{t.push(C(p.ACCOUNT_INVOICES))},{data:T,isError:G,error:ne,reset:ae,isLoading:se,isSuccess:oe,...W}=he(w=>k.post(H.INVOICE_HISTORY.INSERTS,w),{onSuccess:({data:w},{invoiceNumber:b})=>{var j,_;if(((_=(j=w.content)==null?void 0:j.ListeEncarts)==null?void 0:_.length)>0){const K=l({path:p.ACCOUNT_INVOICES,params:{modal:ve},queryParams:{facture:b}});t.push(K)}else{const K=C(p.ACCOUNT_INVOICES_INVOICE_VIEW,{invoice:b});window.open(K,"_blank")}},onError:(w,{invoiceNumber:b})=>{const j=C(p.ACCOUNT_INVOICES_INVOICE_VIEW,{invoice:b});window.open(j,"_blank")}}),ie=(w,b)=>{x(g+b);const{numeroFacture:j,dateFacture:_,motifFacturation:K}=w,pe=r(`invoiceHistory.invoiceLabels.${K}`),ge=Ne(_,"dd/MM/yyyy",new Date);h("INVOICE_CONSULTATION_1",{nature_facture:pe}),W.mutate({invoiceNumber:j,invoiceDate:le(ge,"dd-MM-yyyy")})},te=((S=(E=T==null?void 0:T.data)==null?void 0:E.content)==null?void 0:S.ListeEncarts)||[],Q=d===ve;return P.useEffect(()=>{const{numeroFacture:w,dateFacture:b}=v||{},j=b?Ne(b,"dd/MM/yyyy",new Date):"";if(Q)if(u===-1){const _=C(p.ACCOUNT_INVOICES);t.push(_)}else u>=0&&w&&W.mutate({invoiceNumber:w,invoiceDate:j?le(j,"dd-MM-yyyy"):""})},[]),e.jsxDEV(e.Fragment,{children:[n.slice(g,I).map((w,b)=>{const j=Y("invoice-table border-1 border-gray-100 align-items-baseline py-2 px-3 pl-lg-3",{"border-top":b!==I-1,"border-top border-bottom":b===I-1});return e.jsxDEV(Ke,{data:w,style:j,handleClick:_=>ie(_,b),loading:se&&L===b},b,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceTable.tsx",lineNumber:236,columnNumber:11},void 0)}),e.jsxDEV("div",{className:"d-flex col-5 justify-content-center mx-auto px-0 mt-4",id:"invoice-pagination",children:e.jsxDEV(a.SzPagination,{totalItemsCount:V,activePage:D,onChange:U,itemsCountPerPage:o,pageRangeDisplayed:V,enableDisabled:!0,variant:"custom",aria:{prevLabel:"Previous",nextLabel:"Next"},prevButtonId:"invoice-pagination-prev",nextButtonId:"invoice-pagination-next"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceTable.tsx",lineNumber:246,columnNumber:9},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceTable.tsx",lineNumber:245,columnNumber:7},void 0),e.jsxDEV(a.SzModal,{size:"lg",show:Q,handleClose:R,backdrop:!0,centered:!0,scrollable:!0,border:"smooth",fullscreen:"md",title:"",children:v!=null&&v.numeroFacture?e.jsxDEV(Qe,{insert:te,invoiceAmount:v==null?void 0:v.montantFacture,invoiceType:B,invoiceDate:v==null?void 0:v.dateFacture,invoiceNumber:v.numeroFacture,push:z},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceTable.tsx",lineNumber:274,columnNumber:11},void 0):null},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceTable.tsx",lineNumber:262,columnNumber:7},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceTable.tsx",lineNumber:225,columnNumber:5},void 0)};function Je(){let i=new Date().getFullYear()-2,o=new Date(i,0,1);return Z("InvoiceList",()=>k.post(H.INVOICE_HISTORY.INVOICES_LIST,{minBillingDate:le(o,"yyyy-MM-dd"),currentPage:1,itemsPerPage:999}))}const Ze=n=>{const[i,o]=P.useState(!1),c=me(),r=de(),{toRedirect:m}=ze(),{pathname:t}=r,{icon:d,title:l,description:s,cta:N}=n,{track:h}=X();P.useEffect(()=>{t==="/mon-compte-en-ligne/mes-factures/modale-e-facture"&&o(!0)},[t]);const u=()=>{o(!1),c.push(C(p.ACCOUNT_INVOICES))},f=()=>{h("INVOICE_CONSULTATION_2"),m(N.url)};return e.jsxDEV("div",{className:"push-insert rounded-2 bg-blue-03 p-3 p-lg-4 ml-lg-5 mb-3 mb-lg-0 d-flex flex-column text-center align-items-center order-1 order-lg-0 mx-3 mx-lg-0","data-cy":"push-insert",children:[e.jsxDEV("div",{className:"push-icon-container bg-white rounded-circle p-3 d-flex align-items-center justify-content-center mb-3",children:e.jsxDEV("img",{src:d.src,alt:d.alt,className:"push-icon"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceList.tsx",lineNumber:56,columnNumber:9},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceList.tsx",lineNumber:55,columnNumber:7},void 0),e.jsxDEV(a.SzTypographie,{variant:"H4",weight:"medium",size:"L",children:l},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceList.tsx",lineNumber:58,columnNumber:7},void 0),e.jsxDEV(a.SzTypographie,{weight:"regular",className:"text-dark",tag:"span",children:e.jsxDEV(ce,{content:s},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceList.tsx",lineNumber:62,columnNumber:9},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceList.tsx",lineNumber:61,columnNumber:7},void 0),e.jsxDEV("div",{className:"col-6 mx-auto",children:e.jsxDEV(a.SzButton,{variant:"contained",border:"soft",onClick:f,"data-cy":"push-service",children:N.label},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceList.tsx",lineNumber:65,columnNumber:9},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceList.tsx",lineNumber:64,columnNumber:7},void 0),e.jsxDEV(a.SzModal,{size:"lg",show:i,handleClose:u,backdrop:!0,centered:!0,scrollable:!0,border:"smooth",fullscreen:"md",title:"",children:e.jsxDEV(Ge,{closeModal:u},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceList.tsx",lineNumber:86,columnNumber:9},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceList.tsx",lineNumber:75,columnNumber:7},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceList.tsx",lineNumber:51,columnNumber:5},void 0)},es=()=>{var y,v,V,D,g,I,L;const{t:n}=F(),i=J(),[o,c]=P.useState(1),r=4,m=M=>{c(M)},{data:t,isError:d,isLoading:l}=Je(),{data:s,isLoading:N}=Z("GetDataPushService",()=>k.get(H.INVOICE_HISTORY.PUSH,{params:{type:"service"}})),u=((V=(((v=(y=t==null?void 0:t.data)==null?void 0:y.content)==null?void 0:v.clientFacturesPro)||[])[0])==null?void 0:V.facturesPro)||[],f=Object.keys(((g=(D=s==null?void 0:s.data)==null?void 0:D.content)==null?void 0:g.dataPush)||{}).length>0,x=((L=(I=s==null?void 0:s.data)==null?void 0:I.content)==null?void 0:L.dataPush)||{};return l||N?e.jsxDEV("div",{className:"col-12 px-0 mx-auto",children:e.jsxDEV("div",{className:"bg-white rounded-2 p-4 p-lg-5",children:[e.jsxDEV(O,{width:i?"100%":"30%",height:30,className:"mb-3 mb-lg-4"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceList.tsx",lineNumber:126,columnNumber:11},void 0),e.jsxDEV(O,{width:"100%",height:300},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceList.tsx",lineNumber:131,columnNumber:11},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceList.tsx",lineNumber:125,columnNumber:9},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceList.tsx",lineNumber:124,columnNumber:7},void 0):e.jsxDEV("div",{className:"col-12 px-0 mx-auto",children:e.jsxDEV("div",{className:"bg-white rounded-2 py-4 p-lg-5","data-cy":"invoice-list",children:[e.jsxDEV(a.SzTypographie,{variant:"H3",size:"L",weight:"medium",className:"pl-3 pl-lg-0 mb-3 mb-lg-4",children:n("invoiceHistory.invoiceList.title")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceList.tsx",lineNumber:140,columnNumber:9},void 0),e.jsxDEV("div",{className:"d-flex flex-column flex-lg-row align-items-lg-start",children:[e.jsxDEV("div",{className:"invoice-table-container order-2 order-lg-0",children:!d&&(u==null?void 0:u.length)>0?e.jsxDEV(Xe,{invoiceData:u,currentPage:o,itemsPerPage:r,handlePageChange:m},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceList.tsx",lineNumber:151,columnNumber:15},void 0):e.jsxDEV(a.SzTypographie,{variant:"body",weight:"regular",className:"text-dark mb-3 mb-lg-4",children:n("invoiceHistory.invoiceList.subtitle",{context:d?"error":"empty"})},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceList.tsx",lineNumber:158,columnNumber:15},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceList.tsx",lineNumber:149,columnNumber:11},void 0),f&&e.jsxDEV(Ze,{...x},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceList.tsx",lineNumber:169,columnNumber:38},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceList.tsx",lineNumber:148,columnNumber:9},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceList.tsx",lineNumber:139,columnNumber:7},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/InvoiceList.tsx",lineNumber:138,columnNumber:5},void 0)},ss=()=>{var r,m,t,d,l;const n=J(),{data:i,isLoading:o,isSuccess:c}=Z("GetDataPushHorizontal",()=>k.get(H.INVOICE_HISTORY.PUSH,{params:{type:"horizontal"}}));if(o)return e.jsxDEV("div",{className:"col-12 px-0 mt-4 rounded-2",children:e.jsxDEV(O,{width:"100%",height:200},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/PushBlock.tsx",lineNumber:25,columnNumber:9},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/PushBlock.tsx",lineNumber:24,columnNumber:7},void 0);if(c&&((t=(m=(r=i==null?void 0:i.data)==null?void 0:r.content)==null?void 0:m.dataPush)==null?void 0:t.length)>0){const s=(l=(d=i==null?void 0:i.data)==null?void 0:d.content)==null?void 0:l.dataPush;return e.jsxDEV("div",{className:"push-block d-flex flex-column flex-lg-row",children:s.map((N,h)=>{const u=Y("push-item-invoices overflow-hidden d-flex bg-white rounded-2 cursor-pointer",{"mt-3":n,"mt-4":!n,"mr-4":!n&&h!==s.length-1});return e.jsxDEV(be,{data:N,style:u},h,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/PushBlock.tsx",lineNumber:45,columnNumber:18},void 0)})},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/PushBlock.tsx",lineNumber:34,columnNumber:7},void 0)}return null},is=({className:n})=>{var N,h,u;const{t:i}=F(),c=de().pathname,{data:r,isLoading:m,error:t}=Z("dataHistoPayment",()=>k.get(H.PAYMENT.GET_PAYMENT_HISTO)),d=((N=r==null?void 0:r.data)==null?void 0:N.content)||{},l=((u=(h=t==null?void 0:t.response)==null?void 0:h.data)==null?void 0:u.message)||"",s=typeof l<"u"&&!(l!=null&&l.startsWith("KO_ROLE_"));return l!=null&&l.startsWith("KO_ROLE_")&&c===p.TIMELINE_AND_OPERATIONS&&(window.location.href=p.DASHBOARD),s?e.jsxDEV("div",{className:n,children:e.jsxDEV("div",{className:"bg-white rounded-2 py-4 px-3 p-lg-5 mt-3 mt-lg-4","data-cy":"bloc-payment-histo",children:m?e.jsxDEV(O,{height:300},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/PaymentHistoryChart.tsx",lineNumber:42,columnNumber:11},void 0):e.jsxDEV(e.Fragment,{children:[e.jsxDEV(a.SzTypographie,{variant:"H3",size:"L",weight:"medium",className:"mb-2",children:i("invoiceHistory.paymentList.title")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/PaymentHistoryChart.tsx",lineNumber:45,columnNumber:13},void 0),e.jsxDEV(a.SzTypographie,{variant:"body",weight:"regular",className:"text-dark mb-3 mb-lg-4",children:i("invoiceHistory.paymentList.subtitle")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/PaymentHistoryChart.tsx",lineNumber:53,columnNumber:13},void 0),(d==null?void 0:d.indexMaxData)>0?e.jsxDEV("div",{className:"col-12 pr-3",children:e.jsxDEV(Ue,{data:d},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/PaymentHistoryChart.tsx",lineNumber:62,columnNumber:17},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/PaymentHistoryChart.tsx",lineNumber:61,columnNumber:15},void 0):e.jsxDEV(a.SzTypographie,{variant:"body",weight:"regular",className:"text-dark mb-3 mb-lg-4",children:i("invoiceHistory.paymentList.empty")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/PaymentHistoryChart.tsx",lineNumber:65,columnNumber:15},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/invoice-history/PaymentHistoryChart.tsx",lineNumber:44,columnNumber:11},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/PaymentHistoryChart.tsx",lineNumber:37,columnNumber:7},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/PaymentHistoryChart.tsx",lineNumber:36,columnNumber:5},void 0):null};function di(){var A,B,U,R,T,G,ne,ae,se,oe,W,ie,te,Q,$,q;const{t:n}=F(),i=J(),r=de().pathname===p.TIMELINE_AND_OPERATIONS,{track:m}=X(),{data:t,isLoading:d,isError:l}=Z("GetDataPushMore",()=>k.get(H.INVOICE_HISTORY.PUSH,{params:{type:"more"}})),{modeListPaymentData:s,isLoading:N,promotedValue:h}=we(),u=s==null?void 0:s.currentPaymentModeCode,f=Ve[u],x=[Fe,Le],y=["-","0"],v=typeof(s==null?void 0:s.balanceAmount)<"u"&&(s==null?void 0:s.balanceAmount)!==null&&!y.includes(s==null?void 0:s.balanceAmount.charAt(0)),V=(s==null?void 0:s.paymentModesList)&&Object.values(s==null?void 0:s.paymentModesList).every(E=>!E),D=!x.includes(u)&&v&&!V,g={titleCode:(A=s==null?void 0:s.grayBlock)==null?void 0:A.titleCode,amount:(U=(B=s==null?void 0:s.grayBlock)==null?void 0:B.content)==null?void 0:U.amount,date:(T=(R=s==null?void 0:s.grayBlock)==null?void 0:R.content)==null?void 0:T.date,showEtip:s==null?void 0:s.hasEtipSignedValidMandate,paymentMode:f,currentPaymentModeCode:u,showPayBillButton:D},I=E=>{var S,w;m("INVOICE_CONSULTATION_4",{nom_modale:E==null?void 0:E.type,cas_client:(w=(S=t==null?void 0:t.data)==null?void 0:S.content)==null?void 0:w.clientContext})},M=!["M","P"].includes(u)&&h===null,ee=Y("tsme-container pt-0 pb-6 text-center",{"pt-0":((ae=(ne=(G=t==null?void 0:t.data)==null?void 0:G.content)==null?void 0:ne.dataPush)==null?void 0:ae.length)>0,"pt-4":((W=(oe=(se=t==null?void 0:t.data)==null?void 0:se.content)==null?void 0:oe.dataPush)==null?void 0:W.length)<=0||l}),z=Y("px-0 pr-lg-4 pl-lg-0 col-lg-8",{"col-12":!g||i,"col-lg-8":g});return e.jsxDEV(Ee,{fullscreen:!0,className:"p-0",tag:"main",children:[e.jsxDEV(je,{ellipseImg:Re,zIndex:!0,tag:"div",children:[e.jsxDEV("div",{className:"pt-5 pt-md-3 pt-lg-0",children:[e.jsxDEV("div",{className:"col-12 mt-5",children:e.jsxDEV(a.SzTypographie,{variant:"H1",size:i?"L":"XL",color:"light",className:"text-uppercase",weight:"black",children:n(r?"timelineAndOperations.title":"invoiceHistory.title")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/index.tsx",lineNumber:103,columnNumber:13},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/index.tsx",lineNumber:102,columnNumber:11},this),!r&&e.jsxDEV("div",{className:"mt-4 mt-lg-6",children:[e.jsxDEV(es,{},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/index.tsx",lineNumber:115,columnNumber:15},this),e.jsxDEV(ss,{},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/index.tsx",lineNumber:116,columnNumber:15},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/invoice-history/index.tsx",lineNumber:114,columnNumber:13},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/invoice-history/index.tsx",lineNumber:101,columnNumber:9},this),e.jsxDEV("div",{className:"d-flex flex-column flex-lg-row align-items-lg-start justify-content-lg-center",children:[e.jsxDEV(is,{className:z},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/index.tsx",lineNumber:121,columnNumber:11},this),N?e.jsxDEV("div",{className:"col-12 col-lg-4 px-0 mt-3 mt-lg-4 rounded-2",children:e.jsxDEV(O,{width:"100%",height:360},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/index.tsx",lineNumber:125,columnNumber:15},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/index.tsx",lineNumber:124,columnNumber:13},this):g&&!M?e.jsxDEV("div",{className:"col-12 col-lg-4 px-0",children:e.jsxDEV(Oe,{...g,invoiceVariant:!0},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/index.tsx",lineNumber:129,columnNumber:15},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/index.tsx",lineNumber:128,columnNumber:13},this):null]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/invoice-history/index.tsx",lineNumber:120,columnNumber:9},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/invoice-history/index.tsx",lineNumber:100,columnNumber:7},this),!r&&e.jsxDEV(Ae,{children:d?e.jsxDEV("div",{className:"col-12 px-0 mt-4 rounded-2",children:e.jsxDEV(O,{width:"100%",height:200},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/index.tsx",lineNumber:138,columnNumber:15},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/index.tsx",lineNumber:137,columnNumber:13},this):((Q=(te=(ie=t==null?void 0:t.data)==null?void 0:ie.content)==null?void 0:te.dataPush)==null?void 0:Q.length)>0?e.jsxDEV(e.Fragment,{children:[e.jsxDEV(Be,{title:n("pedagoFacture.board.card_contract_module_title"),items:(q=($=t==null?void 0:t.data)==null?void 0:$.content)==null?void 0:q.dataPush,openCard:I},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/index.tsx",lineNumber:142,columnNumber:15},this),e.jsxDEV("div",{className:ee,children:e.jsxDEV(ue,{variant:"outlined",border:"soft",className:"border-white bg-transparent mb-1 mb-lg-0 text-white",to:p.HELP_AND_CONTACT,id:"invoice-explanation-other-question-btn",onClick:()=>{var E,S;m("INVOICE_CONSULTATION_5",{cas_client:(S=(E=t==null?void 0:t.data)==null?void 0:E.content)==null?void 0:S.clientContext})},children:n("pedagoFacture.board.otherQuestionBtn")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/index.tsx",lineNumber:149,columnNumber:17},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/index.tsx",lineNumber:148,columnNumber:15},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/invoice-history/index.tsx",lineNumber:141,columnNumber:13},this):null},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/invoice-history/index.tsx",lineNumber:135,columnNumber:9},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/invoice-history/index.tsx",lineNumber:99,columnNumber:5},this)}export{di as default};
