import{h as L,k as I,A as U,O as r,d as f,e as R,a as k,ad as M,ae as B,M as j,y as F,t as Q,f as G,W as H}from"./react-spring-web.esm-BXduOQz-.js";import{e as K,r as W,p as J,a as X,b as Y,c as Z}from"./index-CnVkoL_H.js";import{j as o,b as d}from"./index-BAjkLHRS.js";import{r as c}from"./index-Djf8kdDz.js";import{A as ee,a as se,d as ae}from"./index-CzMjzDBE.js";import{u as oe}from"./useInterweave-CyiDgcKg.js";import{u as te}from"./useTranslation-Cclpl_OC.js";function fe(t,e=""){const a=e||"?services[]=efacture&services[]=alerte_fuite&services[]=alerte_conso&services[]=smartcoach";return L("getServicesStatus",()=>I.get(U.SERVICES.STATUS+encodeURI(a)),t||{})}const pe=r({email:K,repeated_email:W()}),he=r({old_password:f().required("mandatory_field"),password:J,repeated_password:X("password")}),ve=r({contract_name:f().max(30,"personalInfos.form.contract.error").required("mandatory_field")}),we=r({mobile_phone:Y.required("mandatory_field")}),be=r({phone:Z.required("mandatory_field")}),D={peopleCount:f().required("mandatory_field"),housingType:f().required("mandatory_field")},Se=r({...D}),Ne=r({...D,consentGiven:R().oneOf([!0],"mandatory_field").required("mandatory_field")}),ge=({sourceType:t="infoPerso",type:e,updatedValue:i,success:a,context:n,toRedirect:u=F(Q.ACCOUNT_PERSONAL_INFORMATIONS),trackingSuccess:S,trackingError:N,onHideCloseModal:m,setShowModal:g})=>{const{t:s}=te(),{transform:x}=oe(),p=k(),[l,A]=c.useState(5);c.useEffect(()=>{if(m){m(!0);let _=setInterval(()=>{A(E=>E<=1?(clearInterval(_),0):E-1)},1e3);return()=>clearInterval(_)}},[m,p,u]),c.useEffect(()=>{l<=1&&p.push(u)},[l]),c.useEffect(()=>{a&&S&&S(),!a&&N&&N()},[e,i,a]);const P=t==="histoConso"?s(`histoConso.${e}.technical_error.title`):s("personalInfos.form.technical_error.title",{date:M,time:B}),h=e==="phone"||e==="mobilePhone",T=s(`personalInfos.form.${e}.validation.title`,{context:n});let v=s(`personalInfos.form.${e}.title`,{context:n});switch(t){case"histoConso":v=s(`histoConso.${e}.title`);break;case"infoPerso":h&&(v=T);break}const O=t==="histoConso"?s(`histoConso.${e}.technical_error.description`):e==="on-connect-desactivation"?s("personalInfos.form.on-connect-desactivation.technical_error"):s("personalInfos.form.technical_error.description",{field:s(`personalInfos.form.${e}.technical_error`),context:e==="e-facture"?"efacture":""}),$=s(`personalInfos.form.${e}.validation.body`,{context:n});let w=s(`personalInfos.form.${e}.validated`);switch(t){case"histoConso":w=s(`histoConso.${e}.validated`,{countdown:l,plural:l>1?"s":""});break;case"infoPerso":h&&(w=$);break}const V=s(`personalInfos.form.${e}.validation.updated`,{updatedValue:i}),y=s(`personalInfos.form.${e}.updated`,{updatedValue:i}),C=()=>{u&&p.push(u),g&&g(!1)},q=a?se:ae,b=["password","on-connect","on-connect-desactivation"],z=a&&!(b!=null&&b.includes(e))&&n!=="erase_ok";return o.jsxDEV(o.Fragment,{children:[o.jsxDEV(d.SzTypographie,{variant:"H3",size:"L",weight:"medium",children:a?v:P},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/UpdateStatus.tsx",lineNumber:150,columnNumber:7},void 0),o.jsxDEV(ee,{className:"my-3 my-lg-4",variant:q,children:o.jsxDEV(d.SzTypographie,{variant:"body",size:"M",weight:"regular",tag:"span",children:o.jsxDEV(j,{content:a?w:O,transform:x},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/UpdateStatus.tsx",lineNumber:155,columnNumber:11},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/UpdateStatus.tsx",lineNumber:154,columnNumber:9},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/UpdateStatus.tsx",lineNumber:153,columnNumber:7},void 0),z&&o.jsxDEV(d.SzTypographie,{variant:"body",size:"L",weight:"regular",tag:"span",children:o.jsxDEV(j,{content:h?V:y,transform:x},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/UpdateStatus.tsx",lineNumber:163,columnNumber:11},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/UpdateStatus.tsx",lineNumber:162,columnNumber:9},void 0),t==="histoConso"&&m?l===0?o.jsxDEV("div",{className:"text-lg-right mt-4 mt-lg-5",children:o.jsxDEV(d.SzButton,{variant:"contained",border:"soft",type:"button",id:"close-btn",onClick:C,children:s("histoConso.on-connect.continue")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/UpdateStatus.tsx",lineNumber:172,columnNumber:13},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/UpdateStatus.tsx",lineNumber:171,columnNumber:11},void 0):null:o.jsxDEV("div",{className:"text-lg-right mt-4 mt-lg-5",children:o.jsxDEV(d.SzButton,{variant:"contained",border:"soft",type:"button",id:"close-btn",onClick:C,children:s("close")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/UpdateStatus.tsx",lineNumber:185,columnNumber:11},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/UpdateStatus.tsx",lineNumber:184,columnNumber:9},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/UpdateStatus.tsx",lineNumber:149,columnNumber:5},void 0)};function xe(t){const e=G(),i=a=>I.post(U.SMARTCOACH.CUSTOMER_ADDITIONAL_INFOS,a);return H(async a=>{const n=await i(a);return e.setQueryData([t],n),n})}export{ge as U,Se as a,fe as b,pe as c,he as d,ve as e,we as f,be as g,Ne as o,xe as u};
