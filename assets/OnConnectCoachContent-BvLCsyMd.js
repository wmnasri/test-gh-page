import{j as e,b as a}from"./index-BAjkLHRS.js";import{r as A}from"./index-Djf8kdDz.js";import{a as Z,W as ee,y as d,t as f,k as ne,A as se,_ as oe,q as ae,V as te,$ as V,L as _}from"./react-spring-web.esm-BXduOQz-.js";import{F as le}from"./index-CMwthcxG.js";import{u as ie,U as re,o as ce,a as ue}from"./usePostCustomerAdditionalInfos-D8Abe1De.js";import{F as x}from"./FormError-B1L9786s.js";/* empty css              *//* empty css                         */import{u as me}from"./useTranslation-Cclpl_OC.js";function de({shouldRedirect:p,withToken:s}){const C=Z();return ee("GetCustomerAdditionalInfos",()=>ne.get(se.SMARTCOACH.CUSTOMER_ADDITIONAL_INFOS,{params:{token:s??!1}}),{onSettled:(n,N)=>{var i;const o=((i=n==null?void 0:n.data)==null?void 0:i.content)||{},l=!!N,r=d(f.ACCOUNT_PERSONAL_INFORMATIONS,{modal:"on-connect"});p&&C.push(r,{isErrorAddInfo:l,...o})}})}const xe=({handleClose:p,source:s="infoPerso",onHideCloseModal:C})=>{var y,S,T;const{t:n}=me(),{track:N}=oe(),o="histoConso",{privacy_policy:l}=(S=(y=window.tsme_data)==null?void 0:y.footer)==null?void 0:S.links_bottom,{state:r}=ae(),{mutate:i,data:b,isError:R,isSuccess:k}=de({shouldRedirect:!1,withToken:!0});A.useEffect(()=>{!r&&s!==o&&i()},[]);const{peopleCount:h,consentGiven:P,housingType:G,isErrorAddInfo:z}=r||{...((T=b==null?void 0:b.data)==null?void 0:T.content)||{},isErrorAddInfo:R},U={infoPerso:"postSmartCoachAddInfoInfoPerso",histoConso:"postSmartCoachAddInfoHistoConso"},{mutate:L,isLoading:O,isError:M,isSuccess:c}=ie(U[s]),{isIntranet:j}=window.tsme_data,F={label:n("save"),align:"right",loader:O,disabled:j||O},H={enabled:!0,label:n("cancel"),align:"left",onClick:p},B=t=>{N("PERSONAL_INFO_7");const v={...t,useCommunityHotWater:"1"};L(v)},q={peopleCount:h||"",housingType:G,consentGiven:P},E=[{label:"1",value:"1"},{label:"2",value:"2"},{label:"3",value:"3"},{label:"4",value:"4"},{label:"5",value:"5"},{label:"6",value:"6"},{label:"7",value:"7"},{label:"8",value:"8"},{label:"9",value:"9"},{label:"10+",value:"10+"}],K=h?E.find(({value:t})=>t===h):{};if(A.useEffect(()=>{c&&s===o&&i({token:!0})},[c]),c||M||z){const t=s===o?d(f.ACCOUNT_CONSUMPTION_TR):d(f.ACCOUNT_PERSONAL_INFORMATIONS);return e.jsxDEV(re,{type:"on-connect",sourceType:s===o?o:"infoPerso",success:c,toRedirect:t,onHideCloseModal:C},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:135,columnNumber:7},void 0)}const W=n(s===o?"histoConso.on-connect.title":"personalInfos.form.on-connect.title"),$=s===o,J=s!==o,Q=d(f.ACCOUNT_PERSONAL_INFORMATIONS,{modal:"on-connect-desactivation"}),X=s===o?ce:ue;return e.jsxDEV("div",{children:[e.jsxDEV(a.SzTypographie,{variant:"H3",size:"L",weight:"medium",children:W},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:168,columnNumber:7},void 0),e.jsxDEV(te,{initialValues:q,validateOnBlur:!1,validateOnChange:!0,validationSchema:X,onSubmit:B,enableReinitialize:!0,children:({handleSubmit:t,handleChange:v,setFieldValue:D,values:u,errors:m,touched:w})=>{const I=g=>{D("housingType",g.target.value)},Y=g=>{D("peopleCount",g.label)};return e.jsxDEV("form",{id:"onConnectCoach",onSubmit:t,className:"on-connect-coach-form",children:[e.jsxDEV("div",{className:"col-12 col-lg-7 px-0 my-4",children:[e.jsxDEV("div",{className:"mb-3",children:[e.jsxDEV(a.SzTypographie,{className:"mb-2",children:n("personalInfos.form.on-connect.people_count_label")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:207,columnNumber:19},void 0),e.jsxDEV(a.SzSelect,{name:"peopleCount",id:"peopleCount",placeholder:n("personalInfos.form.on-connect.people_count_placeholder"),defaultValue:K,options:E,value:u.peopleCount||"",onChange:Y,className:"mb-2"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:210,columnNumber:19},void 0),e.jsxDEV(x,{field:"peopleCount",customDisplay:w.peopleCount&&m.peopleCount},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:222,columnNumber:19},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:206,columnNumber:17},void 0),e.jsxDEV("div",{className:"mb-3",children:[e.jsxDEV(a.SzTypographie,{className:"mb-2",children:n("personalInfos.form.on-connect.housing_type")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:228,columnNumber:19},void 0),e.jsxDEV("div",{className:"d-flex mb-2",children:[e.jsxDEV(a.SzRadio,{id:"housingTypeHouse",name:"housingType",label:n("personalInfos.form.on-connect.type_house"),value:"M",checked:u.housingType==="M",onChange:I},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:232,columnNumber:21},void 0),e.jsxDEV(a.SzRadio,{className:"ml-3",id:"housingTypeApartment",name:"housingType",label:n("personalInfos.form.on-connect.type_apartment"),value:"A",checked:u.housingType==="A",onChange:I},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:240,columnNumber:21},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:231,columnNumber:19},void 0),e.jsxDEV(x,{field:"housingType",customDisplay:w.housingType&&m.housingType},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:250,columnNumber:19},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:227,columnNumber:17},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:205,columnNumber:15},void 0),s===o&&e.jsxDEV("div",{className:"col-12 mt-3 px-0 border-top border-1 border-gray-100 pt-3",children:[e.jsxDEV(a.SzCheckbox,{id:"consentGiven",name:"consentGiven",label:n("personalInfos.form.on-connect.consent"),type:"checkbox",checked:u.consentGiven||!1,onChange:v},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:258,columnNumber:19},void 0),m.consentGiven&&w.consentGiven?e.jsxDEV("div",{"data-cy":"error-consentGiven",role:"alert",children:e.jsxDEV(a.SzTypographie,{variant:"caption",color:"danger",className:"mb-2",children:n(m.consentGiven)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:268,columnNumber:23},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:267,columnNumber:21},void 0):e.jsxDEV(x,{field:"consentGiven"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:277,columnNumber:21},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:257,columnNumber:17},void 0),J&&e.jsxDEV("div",{className:"col-12 mt-3 px-0 border-top border-1 border-gray-100 pt-3",children:e.jsxDEV(a.SzTypographie,{variant:"caption",weight:"regular",size:"M",children:e.jsxDEV(V,{i18nKey:"personalInfos.form.on-connect.unsubscribe.link",components:{redirect:e.jsxDEV(_,{id:"on-connect-unusubscribe-btn",decorate:!0,to:Q},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:288,columnNumber:27},void 0)}},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:284,columnNumber:21},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:283,columnNumber:19},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:282,columnNumber:17},void 0),$&&e.jsxDEV(a.SzTypographie,{variant:"caption",weight:"regular",size:"M",className:"mt-3",children:e.jsxDEV(V,{i18nKey:"loginReset.login.step4.form.mobilePhone.privacy_policy",components:{redirect:e.jsxDEV(_,{className:"font-family-medium",decorate:!0,target:"_blank",to:l==null?void 0:l.link},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:312,columnNumber:25},void 0)}},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:306,columnNumber:19},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:300,columnNumber:17},void 0),e.jsxDEV(le,{previous:H,next:F},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:324,columnNumber:15},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:200,columnNumber:13},void 0)}},k?"reloadOnConnectCoach":"OnConnectCoach",!1,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:172,columnNumber:7},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/personal-infos/modals/OnConnectCoachContent.tsx",lineNumber:167,columnNumber:5},void 0)};export{xe as O,de as u};
