import{r as d}from"./index-Djf8kdDz.js";import{i as E,S}from"./index-Cq_MSTFp.js";var g;(function(e){e[e.Effect=1]="Effect",e[e.LayoutEffect=2]="LayoutEffect"})(g||(g={}));var p=d.useLayoutEffect;function x(e){var r=d.useRef();return r.current||(r.current={v:e()}),r.current.v}var A=function(e,r){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var t=n.call(e),a,i=[],u;try{for(;(r===void 0||r-- >0)&&!(a=t.next()).done;)i.push(a.value)}catch(c){u={error:c}}finally{try{a&&!a.done&&(n=t.return)&&n.call(t)}finally{if(u)throw u.error}}return i},P=function(e){var r=typeof Symbol=="function"&&Symbol.iterator,n=r&&e[r],t=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&t>=e.length&&(e=void 0),{value:e&&e[t++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")};function C(e,r){var n,t,a=A([[],[]],2),i=a[0],u=a[1];try{for(var c=P(e),f=c.next();!f.done;f=c.next()){var s=f.value;r(s)?i.push(s):u.push(s)}}catch(v){n={error:v}}finally{try{f&&!f.done&&(t=c.return)&&t.call(c)}finally{if(n)throw n.error}}return[i,u]}var h=function(e,r){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var t=n.call(e),a,i=[],u;try{for(;(r===void 0||r-- >0)&&!(a=t.next()).done;)i.push(a.value)}catch(c){u={error:c}}finally{try{a&&!a.done&&(n=t.return)&&n.call(t)}finally{if(u)throw u.error}}return i},_=function(e,r,n){if(n||arguments.length===2)for(var t=0,a=r.length,i;t<a;t++)(i||!(t in r))&&(i||(i=Array.prototype.slice.call(r,0,t)),i[t]=r[t]);return e.concat(i||Array.prototype.slice.call(r))};function w(e,r){var n=e.exec,t=n(r.context,r._event.data,{action:e,state:r,_event:r._event});t()}function R(e){var r=d.useRef([]),n=d.useRef([]);p(function(){var t=e.subscribe(function(a){var i,u;if(a.actions.length){var c=a.actions.filter(function(o){return typeof o.exec=="function"&&"__effect"in o.exec}),f=h(C(c,function(o){return o.exec.__effect===g.Effect}),2),s=f[0],v=f[1];(i=r.current).push.apply(i,_([],h(s.map(function(o){return[o,a]})),!1)),(u=n.current).push.apply(u,_([],h(v.map(function(o){return[o,a]})),!1))}});return function(){t.unsubscribe()}},[]),p(function(){for(;n.current.length;){var t=h(n.current.shift(),2),a=t[0],i=t[1];w(a,i)}}),d.useEffect(function(){for(;r.current.length;){var t=h(r.current.shift(),2),a=t[0],i=t[1];w(a,i)}})}var b=function(){return b=Object.assign||function(e){for(var r,n=1,t=arguments.length;n<t;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},b.apply(this,arguments)},I=function(e,r){var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&r.indexOf(t)<0&&(n[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,t=Object.getOwnPropertySymbols(e);a<t.length;a++)r.indexOf(t[a])<0&&Object.prototype.propertyIsEnumerable.call(e,t[a])&&(n[t[a]]=e[t[a]]);return n},$=function(e,r){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var t=n.call(e),a,i=[],u;try{for(;(r===void 0||r-- >0)&&!(a=t.next()).done;)i.push(a.value)}catch(c){u={error:c}}finally{try{a&&!a.done&&(n=t.return)&&n.call(t)}finally{if(u)throw u.error}}return i};function k(e,r,n){if(typeof e=="object")return e;var t=function(){};return{next:e,error:r||t,complete:n||t}}function q(e,r,n){r===void 0&&(r={});var t=x(function(){return typeof e=="function"?e():e});if(typeof e!="function"){var a=$(d.useState(t),1),i=a[0];e!==i&&console.warn("Machine given to `useMachine` has changed between renders. This is not supported and might lead to unexpected results.\nPlease make sure that you pass the same Machine as argument each time.")}var u=r.context,c=r.guards,f=r.actions,s=r.activities,v=r.services,o=r.delays,m=r.state,O=I(r,["context","guards","actions","activities","services","delays","state"]),l=x(function(){var y={context:u,guards:c,actions:f,activities:s,services:v,delays:o},j=t.withConfig(y,function(){return b(b({},t.context),u)});return E(j,b({deferEvents:!0},O))});return p(function(){var y;return n&&(y=l.subscribe(k(n))),function(){y==null||y.unsubscribe()}},[n]),p(function(){return l.start(m?S.create(m):void 0),function(){l.stop()}},[]),p(function(){Object.assign(l.machine.options.actions,f),Object.assign(l.machine.options.guards,c),Object.assign(l.machine.options.activities,s),Object.assign(l.machine.options.services,v),Object.assign(l.machine.options.delays,o)},[f,c,s,v,o]),R(l),l}export{p as i,q as u};
