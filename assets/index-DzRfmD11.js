import{j as e,b as a,a as Me,c as Ce}from"./index-BAjkLHRS.js";import{B as Ae}from"./index-BYcN8_oV.js";import{a as U,M as Ne,O as Z,d as te,e as Ue,_ as B,W as ue,V as me,R as je,t,Y as z,k as ee,A as se,q as $,$ as q,L as he,ao as _e,b8 as Ee,u as Se,af as Ge,b9 as ze,o as Fe,ba as ge,h as Be,bb as Ke,bc as We,ap as xe}from"./react-spring-web.esm-BXduOQz-.js";import{u as De}from"./useInterweave-CyiDgcKg.js";import{A as Le,a as He,d as Xe}from"./index-CzMjzDBE.js";import{c as be}from"./emotion-css.esm-CzHtF_01.js";import{r as b}from"./index-Djf8kdDz.js";import{F as P}from"./FormError-B1L9786s.js";import{m as Ve,p as Ie,a as Te,f as qe,e as Ze,r as $e,g as Qe}from"./index-CnVkoL_H.js";import{F as re}from"./index-CMwthcxG.js";/* empty css              *//* empty css                         */import{u as V}from"./useTranslation-Cclpl_OC.js";import{I as Je,a as Ye}from"./InputSeries-CzwU4lJX.js";import{u as ye}from"./useSearchParams-B1N2HOwe.js";import{c as es,P as Oe,m as Pe}from"./PasswordRules-CNhVV11F.js";import{I as ss,A as ts}from"./InfoBox-m-iA5naR.js";import"./index-BcQ2dhrg.js";import"./index-CCqWUn_M.js";import"./throttle-BPCfK1uX.js";import"./_baseIsEqual-8OBVMFu7.js";import"./iframe-fNLlJobk.js";import"../sb-preview/runtime.js";import"./cross-circle-D-gJHWvz.js";import"./Services-DmhIHDK6.js";const rs=({body:s,description:r,submit:o={label:"",value:""},success:l=!0})=>{const i=U(),{transform:m}=De(),c=l?He:Xe,{label:d,value:E}=o,g=()=>{i.push(E)},w=!!(o.label&&o.value);return e.jsxDEV(e.Fragment,{children:[e.jsxDEV(Le,{className:"my-3 my-lg-4",variant:c,children:[e.jsxDEV(Ne,{content:s,transform:m},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/error.tsx",lineNumber:29,columnNumber:9},void 0),r&&e.jsxDEV(Ne,{content:r,transform:m,className:"d-block mt-3"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/error.tsx",lineNumber:31,columnNumber:11},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/error.tsx",lineNumber:28,columnNumber:7},void 0),w&&e.jsxDEV("div",{className:"text-lg-right mt-4 mt-lg-5",children:e.jsxDEV(a.SzButton,{id:"backLink",variant:"contained",border:"soft",onClick:g,children:d},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/error.tsx",lineNumber:40,columnNumber:11},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/error.tsx",lineNumber:39,columnNumber:9},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/error.tsx",lineNumber:27,columnNumber:5},void 0)};function Re({children:s,title:r,subtitle:o,large:l}){const i=be({backgroundColor:"white",borderRadius:"1rem",position:"relative",margin:"auto",padding:"1.5rem","@media screen and (min-width: 992px)":{padding:"3rem 4rem",maxWidth:l?750:540}});return e.jsxDEV("div",{id:"loginResetContainer",className:i,children:[r&&e.jsxDEV(a.SzTypographie,{variant:"H3",weight:"medium",size:"L",className:"mb-2",children:r},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/LoginResetBox.tsx",lineNumber:34,columnNumber:9},this),o&&e.jsxDEV(a.SzTypographie,{className:"mb-2 text-dark",children:o},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/LoginResetBox.tsx",lineNumber:39,columnNumber:9},this),e.jsxDEV("div",{className:"step-content mt-2",children:s},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/LoginResetBox.tsx",lineNumber:41,columnNumber:7},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/LoginResetBox.tsx",lineNumber:32,columnNumber:5},this)}const os=Z({reference:te().isRef("loginReset.form.errors.invalidRef").required("loginReset.form.errors.mandatory")}),as=Z({telMobile:te().required("loginReset.form.errors.mandatory").matches(Ve,"errors.mobilePhone.invalid")}),is=Z({telFixe:te().required("loginReset.form.errors.mandatory").matches(Ve,"errors.phone.invalid")}),ls=Z({email:te().required("loginReset.form.errors.mandatory").email("errors.email.invalid")}),ns=Z({password:Ie,passwordConfirm:Te("password")}),us=Z({telMobile:te().matches(qe,"errors.mobilePhone.invalid"),email:Ze,repeated_email:$e(),raw_password:Ie,repeated_password:Te("raw_password"),updateEfacture:Ue().nullable()}),ms=Z({postalCode:te().matches(Qe,"loginReset.form.errors.invalidZipcode").required("mandatory_field")});function cs(){const{t:s}=V(),r=U(),[o,l]=b.useState(!1),{recaptcha:i}=window.tsme_data,m=b.useRef(null),{track:c}=B(),{isLoading:d,...E}=ue(x=>ee.post(se.RESET_PASSWORD.SEND_LINK,x),{onSuccess:({data:x},v)=>{x.message===z.OK?(r.push({pathname:t.LOGIN_RESET.PASSWORD.EMAIL_SUCCESS},{userMail:v.email}),c("REINIT_CEL_4")):(r.push(t.LOGIN_RESET.PASSWORD.UPDATE_ERROR),c("REINIT_CEL_3"))},onError:()=>{r.push(t.LOGIN_RESET.PASSWORD.UPDATE_ERROR),c("REINIT_CEL_3")}}),g=async x=>{var S;c("REINIT_CEL_2");const v={...x};i!=null&&i.enabled&&(v["g-recaptcha-response"]=await((S=m==null?void 0:m.current)==null?void 0:S.executeAsync())),E.mutate(v)},w=()=>{l(!0),r.push(t.LOGIN_LOST_ID)},f={label:s("go_back"),align:"left",arrow:!0,enabled:!0,loader:o,onClick:w},R={label:s("validate"),align:"right",loader:d};return e.jsxDEV(me,{initialValues:{email:""},onSubmit:g,validationSchema:ls,validateOnChange:!1,children:({values:x,errors:v,handleChange:S,handleBlur:G,handleSubmit:F})=>e.jsxDEV("form",{onSubmit:F,children:[e.jsxDEV("div",{className:"mt-3 mt-lg-4",children:[e.jsxDEV(a.SzInput,{name:"email",id:"email",variant:"outlined",value:x.email,onChange:S,onBlur:G,label:s("loginReset.password.index.email_label"),placeholder:s("loginReset.password.index.email_placeholder")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/password/index.tsx",lineNumber:92,columnNumber:13},this),e.jsxDEV(P,{field:"email",customDisplay:v.email},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/password/index.tsx",lineNumber:102,columnNumber:13},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/password/index.tsx",lineNumber:91,columnNumber:11},this),(i==null?void 0:i.enabled)&&e.jsxDEV(je,{ref:m,size:"invisible",sitekey:i.invisiblePublicKey,badge:"bottomleft"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/password/index.tsx",lineNumber:105,columnNumber:13},this),e.jsxDEV(re,{previous:f,next:R},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/password/index.tsx",lineNumber:112,columnNumber:11},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/password/index.tsx",lineNumber:90,columnNumber:9},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/password/index.tsx",lineNumber:83,columnNumber:5},this)}function ps(){const s=U(),{transform:r}=De(),{t:o}=V(),{track:l}=B(),[i,m]=b.useState(!1),{state:c}=$(),{userMail:d}=c,E=()=>{s.push(t.LOGIN_RESET.PASSWORD.INDEX),l("REINIT_CEL_5",{solution_choisie_email_non_recu:"renvoi d'email"})},g=()=>{s.push(t.LOGIN_RESET.CUSTOMER_REF),l("REINIT_CEL_5",{solution_choisie_email_non_recu:"recup ID"})},w=()=>{m(!0),s.push(t.HOME)};return e.jsxDEV(e.Fragment,{children:[e.jsxDEV(Le,{className:"mb-3 mb-lg-4",children:e.jsxDEV(Ne,{content:o("loginReset.password.email_success.message",{email:d??""}),transform:r},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/password/email-success.tsx",lineNumber:40,columnNumber:9},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/password/email-success.tsx",lineNumber:39,columnNumber:7},this),e.jsxDEV(a.SzTypographie,{className:"my-3",children:o("loginReset.password.email_success.no_email_received")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/password/email-success.tsx",lineNumber:47,columnNumber:7},this),e.jsxDEV(a.SzButton,{id:"goPrevStep",variant:"text",className:"m-0 p-0 h-auto text-left",icon:"keyboard-arrow-right",alignIcon:"right",type:"submit",onClick:E,children:o("loginReset.password.email_success.no_email_choice1")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/password/email-success.tsx",lineNumber:51,columnNumber:7},this),e.jsxDEV(a.SzButton,{id:"getEditEmail",variant:"text",className:"m-0 p-0 h-auto text-left",icon:"keyboard-arrow-right",alignIcon:"right",onClick:g,children:o("loginReset.password.email_success.no_email_choice2")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/password/email-success.tsx",lineNumber:62,columnNumber:7},this),e.jsxDEV("div",{className:"text-lg-right mt-3 mt-lg-4",children:e.jsxDEV(a.SzButton,{id:"backLink",variant:"contained",border:"soft",onClick:w,loader:i,children:o("loginReset.password.email_success.back")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/password/email-success.tsx",lineNumber:73,columnNumber:9},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/password/email-success.tsx",lineNumber:72,columnNumber:7},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/password/email-success.tsx",lineNumber:38,columnNumber:5},this)}const ds=""+new URL("find-ref-Bi_J5LQ3.png",import.meta.url).href;function ke({isShowModal:s,handleCloseModal:r}){const{t:o}=V();return e.jsxDEV(a.SzModal,{show:s,handleClose:r,size:"lg",backdrop:!0,centered:!0,scrollable:!0,border:"smooth",fullscreen:"md",title:"",children:[e.jsxDEV(a.SzTypographie,{variant:"H3",size:"L",weight:"medium",children:o("loginReset.login.step1.helpRef.modal.title")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/CustomerRefModal.tsx",lineNumber:27,columnNumber:7},this),e.jsxDEV(a.SzTypographie,{variant:"body",weight:"regular",className:"text-dark mb-0",children:o("loginReset.login.step1.helpRef.modal.subtitle")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/CustomerRefModal.tsx",lineNumber:30,columnNumber:7},this),e.jsxDEV("div",{className:"col-12 px-0 my-3 my-lg-4 text-center",children:e.jsxDEV("img",{src:ds,alt:"ref-client",className:"w-100",style:{maxWidth:540}},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/CustomerRefModal.tsx",lineNumber:34,columnNumber:9},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/CustomerRefModal.tsx",lineNumber:33,columnNumber:7},this),e.jsxDEV(a.SzTypographie,{variant:"body",weight:"regular",className:"text-dark mb-5",children:e.jsxDEV(q,{i18nKey:"loginReset.login.step1.helpRef.modal.text",components:{redirect:e.jsxDEV(he,{decorate:!0,to:_e,className:"text-dark"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/CustomerRefModal.tsx",lineNumber:46,columnNumber:15},this)}},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/CustomerRefModal.tsx",lineNumber:42,columnNumber:9},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/CustomerRefModal.tsx",lineNumber:41,columnNumber:7},this),e.jsxDEV("div",{className:"text-center",children:e.jsxDEV(a.SzButton,{variant:"contained",border:"soft",onClick:r,id:"close-pedago-modal",children:o("understood")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/CustomerRefModal.tsx",lineNumber:52,columnNumber:9},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/CustomerRefModal.tsx",lineNumber:51,columnNumber:7},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/CustomerRefModal.tsx",lineNumber:16,columnNumber:5},this)}function gs(){var _;const{t:s}=V(),r=U(),o=$(),[l,i]=b.useState(!1),[m,c]=b.useState(!1),{track:d}=B(),{apiData:E,customerRef:g}=o.state,w=ye(),f=w.get("type")==="mobile-phone",R=w.get("type")==="phone",x=w.get("type")==="invoice-code",{isError:v,error:S,reset:G,isLoading:F,...H}=ue(u=>ee.post(se.RESET_CREDENTIALS.CHECK_USER_INFOS,u),{onSuccess:({data:u})=>{const j=u.content?u.content.info:"",A=u.content?u.content.reference:"";u.message===z.KO_CEL?r.push({pathname:t.LOGIN_RESET.CREATE_CEL},{reference:A}):r.push({pathname:t.LOGIN_RESET.LOGIN_CEL},{email:j,reference:A})},onError:({response:u})=>{var le;const j={KO_NB_REF:t.LOGIN_RESET.ERROR_CONTRACTS,KO_SERVICES:t.LOGIN_RESET.SERVICES_ERROR,KO_RESILIE:t.LOGIN_RESET.CANCELED_ERROR},A=t.LOGIN_RESET.UPDATE_CEL_ERROR,O=(le=u==null?void 0:u.data)==null?void 0:le.message;if(j[O])r.push(j[O]);else{if(["KO_MOBILE","KO_FIXE","KO_ID_CP"].includes(O))return;r.push(A)}}}),Q=async u=>{const A={...u,...Object.fromEntries(["telMobile","telFixe"].filter(Y=>u[Y]).map(Y=>[Y,Ee(u[Y])])),reference:g},{identifier_0:O,identifier_1:le,identifier_2:ve,identifier_3:pe,identifier_4:we,...fe}=A,de=f?"telephone_mobile":R?"telephone_fixe":x?"code":void 0;de&&d("REINIT_CEL_11",{nature_confirmation_identite:de}),H.mutate(fe)},K=()=>{i(!0),r.push(t.LOGIN_RESET.CUSTOMER_REF)},W=()=>{c(!1)},p=()=>{c(!0)},C="col-12 px-0 mb-3 pt-2 pt-lg-3",k={label:s("go_back"),align:"left",arrow:!0,enabled:!0,loader:l,onClick:K},D={label:s("validate"),align:"right",loader:F},h={prefixName:"identifier",length:4,label:s("loginReset.login.step2.label_invoiceCode"),placeholders:["0","0","0","0"]},T={telMobile:""},I={telFixe:""},y={identifier:"",postalCode:""},L=()=>f?T:R?I:y,X=Je({name:h.prefixName,length:4}).concat(ms),M=()=>f?as:R?is:X,ce=()=>f?"mobilePhone":R?"phone":"invoiceCode",{message:J=""}=v?(_=S.response)==null?void 0:_.data:{},oe=v&&J==="KO_MOBILE",ae=v&&J==="KO_FIXE",ie=v&&J==="KO_ID_CP",n=Me({mobilePhone:oe,phone:ae,invoiceCode:ie}),N=s("loginReset.login.step2.mismatch",{context:n});return e.jsxDEV(e.Fragment,{children:[e.jsxDEV(a.SzTypographie,{className:"mb-2 text-dark",children:e.jsxDEV(q,{i18nKey:"loginReset.login.step2.subtitle",context:ce(),values:{info:E},components:{boldText:e.jsxDEV(a.SzTypographie,{weight:"bold",tag:"span"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:231,columnNumber:23},this)}},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:226,columnNumber:9},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:225,columnNumber:7},this),e.jsxDEV(me,{initialValues:L(),onSubmit:Q,validationSchema:M(),validateOnChange:!1,children:({values:u,handleChange:j,handleSubmit:A,handleBlur:O})=>e.jsxDEV("form",{onSubmit:A,children:[f&&e.jsxDEV("div",{className:C,children:[e.jsxDEV(a.SzInput,{name:"telMobile",id:"telMobile",autocomplete:"off",value:u.telMobile,onChange:j,onBlur:O,label:s("loginReset.login.step2.label_mobilePhone"),placeholder:s("loginReset.login.step2.placeholder_phone"),variant:"outlined"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:246,columnNumber:19},this),e.jsxDEV(P,{field:"telMobile"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:257,columnNumber:19},this),oe&&u.telMobile&&e.jsxDEV("div",{"data-cy":"error-telMobile",role:"alert",children:[e.jsxDEV(a.SzTypographie,{variant:"caption",color:"danger",className:"mb-2",children:N},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:260,columnNumber:23},this),e.jsxDEV("span",{className:"sr-only",children:N},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:267,columnNumber:23},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:259,columnNumber:21},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:245,columnNumber:17},this),R&&e.jsxDEV("div",{className:C,children:[e.jsxDEV(a.SzInput,{name:"telFixe",id:"telFixe",autocomplete:"off",value:u.telFixe,onChange:j,onBlur:O,label:s("loginReset.login.step2.label_phone"),placeholder:s("loginReset.login.step2.placeholder_phone"),variant:"outlined"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:274,columnNumber:19},this),e.jsxDEV(P,{field:"telFixe"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:285,columnNumber:19},this),ae&&u.telFixe&&e.jsxDEV("div",{"data-cy":"error-telFixe",role:"alert",children:[e.jsxDEV(a.SzTypographie,{variant:"caption",color:"danger",className:"mb-2",children:N},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:288,columnNumber:23},this),e.jsxDEV("span",{className:"sr-only",children:N},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:295,columnNumber:23},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:287,columnNumber:21},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:273,columnNumber:17},this),x&&e.jsxDEV(e.Fragment,{children:[e.jsxDEV("div",{className:"digit-form pt-3 row w-100 m-0 no-gutters",children:e.jsxDEV(Ye,{...h},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:303,columnNumber:21},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:302,columnNumber:19},this),e.jsxDEV(a.SzButton,{onClick:p,variant:"text",className:"pl-0 mb-3",type:"button","data-cy":"open-help-reference-modal",children:e.jsxDEV(a.SzTypographie,{variant:"caption",size:"M",weight:"regular",children:s("loginReset.login.step2.unknownInfoButton")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:312,columnNumber:21},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:305,columnNumber:19},this),e.jsxDEV(a.SzInput,{name:"postalCode",id:"postalCode",autocomplete:"off",value:u.postalCode,onChange:j,onBlur:O,label:s("loginReset.login.step2.label_zipCode"),placeholder:s("loginReset.login.step2.placeholder_zipCode"),variant:"outlined"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:316,columnNumber:19},this),e.jsxDEV(P,{field:"postalCode",customDisplay:!0},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:329,columnNumber:19},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:301,columnNumber:17},this),ie&&e.jsxDEV("div",{"data-cy":"error-api-validation",role:"alert",children:[e.jsxDEV(a.SzTypographie,{variant:"caption",color:"danger",className:"mb-2",children:N},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:334,columnNumber:19},this),e.jsxDEV("span",{className:"sr-only",children:N},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:341,columnNumber:19},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:333,columnNumber:17},this),!x&&e.jsxDEV(a.SzTypographie,{variant:"caption",weight:"regular",size:"M",children:e.jsxDEV(q,{i18nKey:"loginReset.login.step2.unknownInfoCustomerService",components:{redirect:e.jsxDEV(he,{decorate:!0,to:_e,"data-cy":"redirect-customer-service"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:352,columnNumber:25},this)}},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:346,columnNumber:19},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:345,columnNumber:17},this),e.jsxDEV(re,{previous:k,next:D},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:362,columnNumber:15},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:243,columnNumber:13},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:235,columnNumber:7},this),e.jsxDEV(ke,{handleCloseModal:W,isShowModal:m},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:367,columnNumber:7},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ConfirmContact.tsx",lineNumber:224,columnNumber:5},this)}function ws(){var D;const{t:s}=V(),r=U(),{recaptcha:o}=window.tsme_data,l=b.useRef(null),{track:i}=B(),[m,c]=b.useState(!1),[d,E]=b.useState(!1),g=()=>{E(!1)},w=()=>{E(!0),i("REINIT_CEL_10")},{isError:f,error:R,reset:x,isLoading:v,...S}=ue(h=>ee.post(se.RESET_CREDENTIALS.CHECK_REFERENCE,h),{onSuccess:({data:h},T)=>{const y=`?type=${{[z.OK_TEL_MOBILE]:"mobile-phone",[z.OK_TEL_FIXE]:"phone",[z.OK_ID_CP]:"invoice-code"}[h.message]}`,L=h.content?h.content.info:"",X=T.reference;r.push({pathname:t.LOGIN_RESET.CONFIRM_CONTACT,search:y},{apiData:L,customerRef:X})}}),G=async h=>{var y;const I={...h,...Object.fromEntries(["reference"].filter(L=>h[L]).map(L=>[L,Ee(h[L])]))};o!=null&&o.enabled&&(I["g-recaptcha-response"]=await((y=l==null?void 0:l.current)==null?void 0:y.executeAsync())),i("REINIT_CEL_9"),S.mutate(I)},F=()=>{c(!0),r.push(t.LOGIN_LOST_ID)},H={label:s("go_back"),align:"left",arrow:!0,enabled:!0,loader:m,onClick:F},Q={label:s("validate"),align:"right",loader:v},{message:K=""}=f?(D=R.response)==null?void 0:D.data:{},W=f?K==="KO_REF":!1,p=f?K==="KO_CAPTCHA":!1,k=W?"loginReset.login.step1.error":p?"loginReset.login.step1.error_captcha":"errors.techError";return e.jsxDEV(e.Fragment,{children:[e.jsxDEV(me,{initialValues:{reference:""},onSubmit:G,validationSchema:os,validateOnChange:!1,children:({values:h,errors:T,handleChange:I,handleSubmit:y,handleBlur:L})=>e.jsxDEV("form",{onSubmit:y,children:[e.jsxDEV("div",{className:"col-12 px-0 pt-2 pt-lg-3",children:[e.jsxDEV(a.SzInput,{name:"reference",id:"reference",autocomplete:"off",value:h.reference,onChange:I,onBlur:L,label:s("loginReset.login.step1.label"),placeholder:s("loginReset.login.step1.placeholder"),variant:"outlined"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/CustomerRef.tsx",lineNumber:133,columnNumber:17},this),e.jsxDEV(P,{field:"reference",customDisplay:T.reference},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/CustomerRef.tsx",lineNumber:144,columnNumber:17},this),f&&h.reference&&e.jsxDEV("div",{"data-cy":"error-reference",role:"alert",children:[e.jsxDEV(a.SzTypographie,{variant:"caption",color:"danger",className:"mb-2",children:s(k)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/CustomerRef.tsx",lineNumber:147,columnNumber:21},this),e.jsxDEV("span",{className:"sr-only",children:s(k)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/CustomerRef.tsx",lineNumber:154,columnNumber:21},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/CustomerRef.tsx",lineNumber:146,columnNumber:19},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/CustomerRef.tsx",lineNumber:132,columnNumber:15},this),e.jsxDEV(a.SzButton,{onClick:w,variant:"text",className:"pl-0",type:"button","data-cy":"open-help-reference-modal",children:e.jsxDEV(a.SzTypographie,{variant:"caption",size:"M",weight:"regular",children:s("loginReset.login.step1.helpRef.button")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/CustomerRef.tsx",lineNumber:166,columnNumber:17},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/CustomerRef.tsx",lineNumber:159,columnNumber:15},this),(o==null?void 0:o.enabled)&&e.jsxDEV(je,{ref:l,size:"invisible",sitekey:o.invisiblePublicKey,badge:"bottomleft"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/CustomerRef.tsx",lineNumber:171,columnNumber:17},this),e.jsxDEV(re,{previous:H,next:Q},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/CustomerRef.tsx",lineNumber:178,columnNumber:15},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/CustomerRef.tsx",lineNumber:131,columnNumber:13},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/CustomerRef.tsx",lineNumber:121,columnNumber:7},this),e.jsxDEV(ke,{handleCloseModal:g,isShowModal:d},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/CustomerRef.tsx",lineNumber:183,columnNumber:7},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/CustomerRef.tsx",lineNumber:120,columnNumber:5},this)}function fs(){const s=U(),{t:r}=V(),{track:o}=B();b.useEffect(()=>{o("REINIT_CEL_12",{etat_cel:"client_connu_pls_contrats"})},[]);const l={label:r("loginReset.login.step3.error_contracts.button"),align:"right",onClick:()=>{s.push(t.CUSTOMER_SERVICE)}};return e.jsxDEV(re,{next:l},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ErrorContracts.tsx",lineNumber:25,columnNumber:10},this)}const Ns="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M13.045%2014.136L9.33301%2014.667L9.86301%2010.954L19.409%201.40804C19.831%200.986078%2020.4033%200.749023%2021%200.749023C21.2955%200.749023%2021.5881%200.807222%2021.8611%200.920296C22.134%201.03337%2022.3821%201.1991%2022.591%201.40804C22.7999%201.61697%2022.9657%201.86501%2023.0787%202.13799C23.1918%202.41098%2023.25%202.70356%2023.25%202.99904C23.25%203.29451%2023.1918%203.5871%2023.0787%203.86008C22.9657%204.13306%2022.7999%204.3811%2022.591%204.59004L13.045%2014.136Z'%20stroke='%23030F40'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M18.3477%202.46924L21.5297%205.65124'%20stroke='%23030F40'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M18.75%2014.25V21.75C18.75%2022.1478%2018.592%2022.5294%2018.3107%2022.8107C18.0294%2023.092%2017.6478%2023.25%2017.25%2023.25H2.25C1.85218%2023.25%201.47064%2023.092%201.18934%2022.8107C0.908035%2022.5294%200.75%2022.1478%200.75%2021.75V6.75C0.75%206.35218%200.908035%205.97064%201.18934%205.68934C1.47064%205.40804%201.85218%205.25%202.25%205.25H9.75'%20stroke='%233D466C'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",bs="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M12%2011.25C14.8995%2011.25%2017.25%208.8995%2017.25%206C17.25%203.10051%2014.8995%200.75%2012%200.75C9.10051%200.75%206.75%203.10051%206.75%206C6.75%208.8995%209.10051%2011.25%2012%2011.25Z'%20stroke='%23030F40'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M2.25%2023.25C2.25%2020.6641%203.27723%2018.1842%205.10571%2016.3557C6.93419%2014.5272%209.41414%2013.5%2012%2013.5C14.5859%2013.5%2017.0658%2014.5272%2018.8943%2016.3557C20.7228%2018.1842%2021.75%2020.6641%2021.75%2023.25'%20stroke='%23030F40'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e";function hs(){const{t:s}=V(),r=Se(),o=$(),l=U(),{track:i}=B();b.useEffect(()=>{i("REINIT_CEL_12",{etat_cel:"client_connu"})},[]);const{email:m,reference:c}=o.state,d=[{onClick:()=>{l.push({pathname:t.LOGIN},{userMail:m}),i("REINIT_CEL_13")},picto:{src:bs,alt:""},label:s("loginReset.login.step3.login_cel.button_login"),dataCy:"redirect-login"},{onClick:()=>{l.push(t.LOGIN_RESET.UPDATE_LOGIN),i("REINIT_CEL_14")},picto:{src:Ns,alt:""},label:s("loginReset.login.step3.login_cel.button_reset"),dataCy:"redirect-login-reset"}];return e.jsxDEV("div",{children:[e.jsxDEV(a.SzTypographie,{className:"mb-2 text-dark",children:e.jsxDEV(q,{i18nKey:"loginReset.login.step3.login_cel.subtitle",values:{customerRef:c,email:m},components:{boldText:e.jsxDEV(a.SzTypographie,{weight:"bold",tag:"span"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/LoginCel.tsx",lineNumber:64,columnNumber:23},this)}},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/LoginCel.tsx",lineNumber:60,columnNumber:9},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/LoginCel.tsx",lineNumber:59,columnNumber:7},this),d.map((E,g)=>{const{onClick:w,picto:f,label:R,dataCy:x}=E,v=Ce("shadow-sm",{"mb-3":g!==d.length-1,"mt-3 mt-lg-4":g===0}),S=be({width:r?15:24,height:r?15:24}),G=be({fontSize:"0.9rem !important",marginLeft:"auto"});return e.jsxDEV(Ge,{backgroundColor:"white",className:v,children:e.jsxDEV("div",{className:"d-flex align-items-center p-3 p-lg-4 cursor-pointer",onClick:w,"data-cy":x,children:[e.jsxDEV("div",{className:"bg-gray-200 rounded-circle d-flex align-items-center justify-content-center p-2",children:e.jsxDEV("img",{src:f.src,alt:f.alt,className:S},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/LoginCel.tsx",lineNumber:94,columnNumber:17},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/LoginCel.tsx",lineNumber:93,columnNumber:15},this),e.jsxDEV(a.SzTypographie,{className:"text-dark ml-3 mb-0 mr-3 mr-sm-0",size:"XL",children:e.jsxDEV(q,{i18nKey:R,components:{boldText:e.jsxDEV(a.SzTypographie,{weight:"bold",tag:"span"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/LoginCel.tsx",lineNumber:103,columnNumber:31},this)}},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/LoginCel.tsx",lineNumber:100,columnNumber:17},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/LoginCel.tsx",lineNumber:96,columnNumber:15},this),e.jsxDEV(a.SzIcon,{icon:"arrow-right-1",variant:"line",className:G},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/LoginCel.tsx",lineNumber:107,columnNumber:15},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/LoginCel.tsx",lineNumber:88,columnNumber:13},this)},g,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/LoginCel.tsx",lineNumber:87,columnNumber:11},this)})]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/LoginCel.tsx",lineNumber:58,columnNumber:5},this)}function Es(){const{t:s}=V(),r=U(),o=$(),{track:l}=B();b.useEffect(()=>{l("REINIT_CEL_12",{etat_cel:"client_inexistant"})},[]);const{reference:i}=o.state;return e.jsxDEV(e.Fragment,{children:[e.jsxDEV(a.SzTypographie,{className:"mb-2 text-dark",children:e.jsxDEV(q,{i18nKey:"loginReset.login.step3.create_cel.subtitle",values:{customerRef:i}},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/CreateCel.tsx",lineNumber:26,columnNumber:9},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/CreateCel.tsx",lineNumber:25,columnNumber:7},this),e.jsxDEV("div",{className:"mt-4 d-flex justify-content-end",children:e.jsxDEV(a.SzButton,{variant:"contained",border:"soft",id:"createCelButton",onClick:()=>r.push(t.SIGN_UP,{from:ze}),children:s("loginReset.login.step3.create_cel.button")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/CreateCel.tsx",lineNumber:32,columnNumber:9},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/CreateCel.tsx",lineNumber:31,columnNumber:7},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/CreateCel.tsx",lineNumber:24,columnNumber:5},this)}function vs(){var ce,J,oe,ae,ie;const{t:s}=V(),r=Fe(),o=U(),{state:l}=$(),[i,m]=b.useState(!1),[c,d]=b.useState(!1),[E,g]=b.useState(null),{track:w}=B(),f={telMobile:"",email:(l==null?void 0:l.userMail)??"",repeated_email:(l==null?void 0:l.userMail)??"",raw_password:"",repeated_password:""},[R,x]=b.useState({...f}),{link:v}=(oe=(J=(ce=window.tsme_data)==null?void 0:ce.footer)==null?void 0:J.links_bottom)==null?void 0:oe.privacy_policy,{isError:S,error:G,reset:F,isLoading:H,isSuccess:Q,...K}=ue(n=>ee.post(se.RESET_CREDENTIALS.REINIT_ACCOUNT,n),{onSuccess:({data:n},N)=>{var _;if(n.message===z.KO_EFACTURE){const u={...N};d(!0),g((_=n==null?void 0:n.content)==null?void 0:_.info),x(u)}else n.message===z.OK&&(o.push(t.LOGIN_RESET.UPDATE_CEL_SUCCESS),w("REINIT_CEL_15"))},onError:({response:n})=>{var N;n.data.message===z.KO_LOGIN?o.push({pathname:t.LOGIN_RESET.UPDATE_CEL_EXISTING_ERROR},{userMail:(N=n.data.content)==null?void 0:N.info}):n.data.message!=="global.form_has_errors"&&(o.push(t.LOGIN_RESET.UPDATE_CEL_ERROR),w("REINIT_CEL_16"))}}),W=Ce("border-bottom sz-border-1 pt-3 pb-3 pb-lg-4",{"border-top":r}),p=b.useRef(null),C={showPasswordLabel:s("global.form.password",{context:"show"}),hidePasswordLabel:s("global.form.password",{context:"hide"})},k=S?(ie=(ae=G.response)==null?void 0:ae.data)==null?void 0:ie.validation_errors:{},D=k?Object.keys(k):[],h=D.includes("telMobile"),T=D.includes("email[first]"),I=D.includes("email[second]"),y=D.includes("password[first]"),L=D.includes("password[second]"),X=async n=>{const N={...n,...c&&{updateEfacture:n.updateEfacture||!1},telMobile:Ee(n.telMobile),"login[first]":n.email,"login[second]":n.repeated_email,"password[first]":n.raw_password,"password[second]":n.repeated_password},{email:_,repeated_email:u,raw_password:j,repeated_password:A,...O}=N;K.mutate(O)},M=({dataCy:n,message:N})=>{const{t:_}=V();return e.jsxDEV("div",{"data-cy":n,role:"alert",children:[e.jsxDEV(a.SzTypographie,{variant:"caption",color:"danger",className:"mb-2",children:_(N)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:140,columnNumber:9},this),e.jsxDEV("span",{className:"sr-only",children:_(N)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:143,columnNumber:9},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:139,columnNumber:7},this)};return e.jsxDEV(me,{initialValues:R,onSubmit:X,validationSchema:us,validateOnChange:!1,children:({values:n,errors:N,touched:_,handleChange:u,handleBlur:j,handleSubmit:A,setFieldValue:O})=>{const le=({target:ne})=>{O("updateEfacture",!!ne.checked)},ve={title:s("signUp.step3.eFacture.receive_on_mail"),eFactureContact:E,checkboxLabel:s("signUp.step3.eFacture.confirm_login_mail"),checkboxValue:n.updateEfacture,handleChange:le},pe=es(n.raw_password),we=Object.values(pe).every(ne=>ne),fe=Pe(pe),de=()=>{we||m(!0)},Y=ne=>{m(!1),j(ne)};return b.useEffect(()=>{we?m(!1):document.activeElement===p.current&&m(!0)},[pe]),e.jsxDEV("form",{onSubmit:A,autoComplete:"off",children:[e.jsxDEV("div",{className:"mt-3 mb-4",children:[e.jsxDEV(a.SzInput,{name:"telMobile",id:"telMobile",autocomplete:"off",value:n.telMobile,onChange:u,onBlur:j,label:s("loginReset.login.step4.form.mobilePhone.label"),placeholder:s("loginReset.login.step4.form.mobilePhone.placeholder"),variant:"outlined",info:s("loginReset.login.step4.form.mobilePhone.info"),infoPosition:"label",infoDetached:!0},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:208,columnNumber:15},this),e.jsxDEV(P,{field:"telMobile",customDisplay:_.telMobile&&N.telMobile},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:224,columnNumber:15},this),h&&n.telMobile&&e.jsxDEV(M,{dataCy:"error-api-telMobile",message:"errors.mobilePhone.invalid"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:229,columnNumber:17},this),e.jsxDEV(a.SzTypographie,{variant:"caption",weight:"regular",size:"M",children:e.jsxDEV(q,{i18nKey:"loginReset.login.step4.form.mobilePhone.privacy_policy",components:{redirect:e.jsxDEV(he,{className:"font-family-medium",decorate:!0,target:"_blank",to:v},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:241,columnNumber:23},this)}},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:235,columnNumber:17},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:234,columnNumber:15},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:207,columnNumber:13},this),e.jsxDEV("div",{className:W,children:[e.jsxDEV("div",{className:"mb-3",children:[e.jsxDEV(a.SzInput,{variant:"outlined",name:"email",id:"email",autocomplete:"off",onChange:u,onBlur:j,value:n.email,label:s("loginReset.login.step4.form.mail.label"),onPaste:ge,"aria-required":"true",placeholder:s("loginReset.login.step4.form.mail.placeholder")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:255,columnNumber:17},this),e.jsxDEV(P,{field:"email",customDisplay:_.email&&N.email},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:270,columnNumber:17},this),T&&e.jsxDEV(M,{dataCy:"error-api-email",message:"errors.email.invalid"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:275,columnNumber:19},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:254,columnNumber:15},this),e.jsxDEV(a.SzInput,{variant:"outlined",name:"repeated_email",id:"repeated_email",autocomplete:"off",onChange:u,onBlur:j,value:n.repeated_email,label:s("loginReset.login.step4.form.mail.confirm_label"),onPaste:ge,"aria-required":"true",placeholder:s("loginReset.login.step4.form.mail.placeholder")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:281,columnNumber:15},this),e.jsxDEV(P,{field:"repeated_email",customDisplay:_.repeated_email&&N.repeated_email},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:294,columnNumber:15},this),I&&e.jsxDEV(M,{dataCy:"error-api-repeated_email",message:"loginReset.form.errors.email_invalid"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:299,columnNumber:17},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:253,columnNumber:13},this),e.jsxDEV("div",{className:"position-relative mb-3 mt-3",children:[e.jsxDEV(a.SzInput,{ref:p,variant:"outlined",name:"raw_password",id:"raw_password",autocomplete:"new-password",type:"password",onChange:u,onBlur:Y,onFocus:de,value:n.raw_password,label:s("loginReset.login.step4.form.password.label"),showPassword:!0,onPaste:ge,"aria-describedby":"password-rules","aria-required":"true",aria:C,placeholder:s("loginReset.login.step4.form.password.placeholder")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:306,columnNumber:15},this),e.jsxDEV(Oe,{password:n.raw_password,className:"position-absolute bg-blue-03 rounded-2",show:i},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:327,columnNumber:15},this),e.jsxDEV(P,{field:"raw_password",messageAccess:fe,customDisplay:_.raw_password&&N.raw_password},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:332,columnNumber:15},this),y&&e.jsxDEV(M,{dataCy:"error-api-raw_password",message:"loginReset.form.errors.invalidPassword"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:338,columnNumber:17},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:305,columnNumber:13},this),e.jsxDEV(a.SzInput,{variant:"outlined",name:"repeated_password",id:"repeated_password",autocomplete:"off",type:"password",onBlur:j,onChange:u,value:n.repeated_password,label:s("loginReset.login.step4.form.password.confirm_label"),showPassword:!0,onPaste:ge,aria:C,placeholder:s("loginReset.login.step4.form.password.confirm_placeholder")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:344,columnNumber:13},this),e.jsxDEV(P,{field:"repeated_password",customDisplay:_.repeated_password&&N.repeated_password},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:361,columnNumber:13},this),L&&e.jsxDEV(M,{dataCy:"error-api-repeated_password",message:"loginReset.form.errors.invalidPassword"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:368,columnNumber:15},this),c&&e.jsxDEV(ss,{...ve},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:374,columnNumber:33},this),e.jsxDEV("div",{className:"d-flex justify-content-lg-end mt-4",children:e.jsxDEV(a.SzButton,{type:"submit",variant:"contained",border:"soft",loader:H,id:"login-reset-step3-submit",children:s("loginReset.login.step4.form.button")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:376,columnNumber:15},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:375,columnNumber:13},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:206,columnNumber:11},this)}},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/UpdateLogin.tsx",lineNumber:149,columnNumber:5},this)}function xs(){var W;const s=U(),{t:r}=V(),o=b.useRef(null),l=ye(),{track:i}=B(),[m,c]=b.useState(!1),d=l.get("token"),{isIdle:E}=Be(["checkToken",d],()=>ee.get(se.RESET_PASSWORD.CHECK_TOKEN,{params:{token:d}}),{onSuccess:({data:p})=>{z.OK===p.message?s.push({pathname:t.LOGIN_RESET.PASSWORD.UPDATE,search:`?token=${d}`}):s.push(t.LOGIN_RESET.PASSWORD.EMAIL_ERROR)},onError:()=>{s.push(t.LOGIN_RESET.PASSWORD.EMAIL_ERROR)},enabled:!!d}),{isError:g,error:w,reset:f,isLoading:R,...x}=ue(p=>ee.post(se.RESET_PASSWORD.SET_PASSWORD,p),{onSuccess:({data:p})=>{p.message===z.OK?(s.push(t.LOGIN_RESET.PASSWORD.UPDATE_SUCCESS),i("REINIT_CEL_7")):i("REINIT_CEL_8")},onError:({response:p})=>{var C;((C=p==null?void 0:p.data)==null?void 0:C.message)!=="KO_MDP"&&(s.push(t.LOGIN_RESET.PASSWORD.UPDATE_ERROR),i("REINIT_CEL_8"))}}),v={showPasswordLabel:r("global.form.password",{context:"show"}),hidePasswordLabel:r("global.form.password",{context:"hide"})},S={label:r("save"),align:"right",loader:R},G=async p=>{i("REINIT_CEL_6");const C={...p,"password[first]":p.password,"password[second]":p.passwordConfirm},{password:k,passwordConfirm:D,...h}=C;x.mutate(h)},F=p=>{p.preventDefault()},{message:H=""}=g?(W=w.response)==null?void 0:W.data:{},Q=g?H==="KO_MDP":!1,K={password:"",passwordConfirm:"",token:d};return d&&E?null:e.jsxDEV(me,{initialValues:K,validateOnBlur:!0,validationSchema:ns,onSubmit:G,children:({values:p,errors:C,handleChange:k,handleBlur:D,handleSubmit:h})=>{const T=Ke(p.password),I=Object.values(T).every(M=>M),y=Pe(T);b.useEffect(()=>{I?c(!1):!I&&document.activeElement===o.current&&c(!0)},[T]);const L=M=>{c(!1),D(M)},X=()=>{I||c(!0)};return e.jsxDEV("form",{id:"loginResetPasswordUpdate",onSubmit:h,children:[e.jsxDEV("div",{className:"row",children:[e.jsxDEV("div",{className:"col-12 my-3 position-relative",children:[e.jsxDEV(a.SzInput,{id:"password",name:"password",label:r("loginReset.password.update.password"),placeholder:r("loginReset.password.update.password_placeholder"),value:p.password,autocomplete:"off",showPassword:!0,ref:o,type:"password",variant:"outlined",error:!!C.password,onChange:k,onBlur:L,onFocus:X,onPaste:F,"aria-describedby":"password-rules","aria-required":"true",aria:v},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/password/update.tsx",lineNumber:161,columnNumber:17},this),e.jsxDEV(Oe,{password:p.password,className:"position-absolute bg-blue-03 rounded-2",show:m},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/password/update.tsx",lineNumber:183,columnNumber:17},this),e.jsxDEV(P,{field:"password",customDisplay:C.password,messageAccess:y},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/password/update.tsx",lineNumber:188,columnNumber:17},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/password/update.tsx",lineNumber:160,columnNumber:15},this),e.jsxDEV("div",{className:"col-12 my-3",children:[e.jsxDEV(a.SzInput,{id:"passwordConfirm",name:"passwordConfirm",label:r("loginReset.password.update.password_confirm"),placeholder:r("loginReset.password.update.password_confirm_placeholder"),type:"password",variant:"outlined",value:p.passwordConfirm,error:!!C.passwordConfirm,onBlur:D,onChange:k,onPaste:F,autocomplete:"off",showPassword:!0,aria:v},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/password/update.tsx",lineNumber:195,columnNumber:17},this),e.jsxDEV(P,{field:"passwordConfirm",customDisplay:C.passwordConfirm},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/password/update.tsx",lineNumber:213,columnNumber:17},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/password/update.tsx",lineNumber:194,columnNumber:15},this),Q&&e.jsxDEV("div",{"data-cy":"error-password",role:"alert",children:[e.jsxDEV(a.SzTypographie,{variant:"caption",color:"danger",className:"mb-2",children:r("loginReset.form.errors.invalidPassword")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/password/update.tsx",lineNumber:220,columnNumber:19},this),e.jsxDEV("span",{className:"sr-only",children:r("loginReset.form.errors.invalidPassword")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/password/update.tsx",lineNumber:227,columnNumber:19},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/password/update.tsx",lineNumber:219,columnNumber:17},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/password/update.tsx",lineNumber:159,columnNumber:13},this),e.jsxDEV(re,{next:S},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/password/update.tsx",lineNumber:234,columnNumber:13},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/password/update.tsx",lineNumber:158,columnNumber:11},this)}},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/password/update.tsx",lineNumber:121,columnNumber:5},this)}function Rs(){const{t:s}=V(),r=U(),{state:o}=$(),[l,i]=b.useState(!1),[m,c]=b.useState(!1),{userMail:d}=o,E=()=>{i(!0),r.push({pathname:t.LOGIN_RESET.UPDATE_LOGIN},{userMail:d})},g=()=>{c(!0),r.push({pathname:t.LOGIN},{userMail:d})},w={label:s("loginReset.login.existing_error.correction_btn"),align:"left",arrow:!0,enabled:!0,loader:l,onClick:E},f={label:s("loginReset.login.existing_error.connexion_btn"),align:"right",loader:m,onClick:g};return e.jsxDEV(re,{previous:w,next:f},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/steps/ExistingCel.tsx",lineNumber:53,columnNumber:10},this)}function Cs(){const{t:s}=V();return[{step:ws,path:t.LOGIN_RESET.CUSTOMER_REF,title:s("loginReset.login.step1.title"),subtitle:s("loginReset.login.step1.subtitle")},{step:gs,path:t.LOGIN_RESET.CONFIRM_CONTACT,title:s("loginReset.login.step2.title")},{step:ps,path:t.LOGIN_RESET.PASSWORD.EMAIL_SUCCESS,title:s("loginReset.password.email_success.title"),large:!0},{step:fs,path:t.LOGIN_RESET.ERROR_CONTRACTS,title:s("loginReset.login.step3.error_contracts.title"),subtitle:s("loginReset.login.step3.error_contracts.subtitle")},{step:hs,path:t.LOGIN_RESET.LOGIN_CEL,title:s("loginReset.login.step3.login_cel.title")},{step:Es,path:t.LOGIN_RESET.CREATE_CEL,title:s("loginReset.login.step3.create_cel.title")},{step:vs,path:t.LOGIN_RESET.UPDATE_LOGIN,title:s("loginReset.login.step4.title")},{step:Rs,path:t.LOGIN_RESET.UPDATE_CEL_EXISTING_ERROR,title:s("loginReset.login.existing_error.title"),subtitle:s("loginReset.login.existing_error.subtitle"),large:!0},{error:!0,path:t.LOGIN_RESET.UPDATE_CEL_SUCCESS,title:s("loginReset.login.update_success.title"),body:s("loginReset.login.update_success.body"),submit:{label:s("loginReset.login.update_success.submit"),value:t.LOGIN}},{error:!0,success:!1,path:t.LOGIN_RESET.UPDATE_CEL_ERROR,title:s("loginReset.login.update_error.title"),body:s("loginReset.login.update_error.body"),submit:{label:s("loginReset.login.update_error.submit"),value:t.LOGIN_RESET.CUSTOMER_REF}},{error:!0,success:!1,path:t.LOGIN_RESET.SERVICES_ERROR,title:s("loginReset.login.error_services.title"),body:s("loginReset.login.error_services.body"),description:s("loginReset.login.error_services.description")},{error:!0,success:!1,path:t.LOGIN_RESET.CANCELED_ERROR,title:s("loginReset.login.error_services.title"),body:s("loginReset.login.error_canceled.body"),description:s("loginReset.login.error_canceled.description")},{error:!0,success:!1,path:t.LOGIN_RESET.PASSWORD.EMAIL_ERROR,title:s("loginReset.password.email_error.title"),body:s("loginReset.password.email_error.body"),submit:{label:s("loginReset.password.email_error.submit"),value:t.LOGIN_RESET.PASSWORD.INDEX}},{step:xs,path:t.LOGIN_RESET.PASSWORD.UPDATE,title:s("loginReset.password.update.title"),subtitle:s("loginReset.password.update.subtitle")},{error:!0,path:t.LOGIN_RESET.PASSWORD.UPDATE_SUCCESS,title:s("loginReset.password.update_success.title"),body:s("loginReset.password.update_success.body"),submit:{label:s("loginReset.password.update_success.submit"),value:t.LOGIN}},{error:!0,success:!1,path:t.LOGIN_RESET.PASSWORD.UPDATE_ERROR,title:s("loginReset.password.update_error.title"),body:s("loginReset.password.update_error.body"),submit:{label:s("loginReset.password.update_error.submit"),value:t.LOGIN_RESET.PASSWORD.INDEX}},{step:cs,path:t.LOGIN_RESET.PASSWORD.INDEX,title:s("loginReset.password.index.title"),subtitle:s("loginReset.password.index.subtitle")}]}function js(){const s=Cs();return e.jsxDEV(We,{children:s.map(r=>{if(r.error){const{body:d,description:E,path:g,title:w,submit:f,success:R}=r;return e.jsxDEV(xe,{path:g,children:e.jsxDEV(Re,{title:w,large:!0,children:e.jsxDEV(rs,{body:d,description:E,submit:f,success:R},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/LoginResetStepper.tsx",lineNumber:19,columnNumber:17},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/LoginResetStepper.tsx",lineNumber:18,columnNumber:15},this)},g,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/LoginResetStepper.tsx",lineNumber:17,columnNumber:13},this)}const{path:o,title:l,subtitle:i,large:m,step:c}=r;return e.jsxDEV(xe,{path:o,children:e.jsxDEV(Re,{title:l,subtitle:i,large:m,children:e.jsxDEV(c,{},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/LoginResetStepper.tsx",lineNumber:35,columnNumber:15},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/LoginResetStepper.tsx",lineNumber:34,columnNumber:13},this)},o,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/LoginResetStepper.tsx",lineNumber:33,columnNumber:11},this)})},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/LoginResetStepper.tsx",lineNumber:11,columnNumber:5},this)}function Qs(){const{t:s}=V(),r=Se(),i=$().pathname===t.LOGIN_RESET.CREATE_CEL;return e.jsxDEV(e.Fragment,{children:[e.jsxDEV(Ae,{id:"loginResetPage",type:"login-reset",customMinHeight:i?"calc(100vh - 461px)":void 0,children:[e.jsxDEV(a.SzTypographie,{variant:"H1",size:r?"L":"XL",align:"center",color:"light",weight:"black",className:"mb-4 text-uppercase",children:s("loginReset.title")},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/index.tsx",lineNumber:28,columnNumber:9},this),e.jsxDEV(js,{},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/index.tsx",lineNumber:38,columnNumber:9},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/index.tsx",lineNumber:21,columnNumber:7},this),i&&e.jsxDEV(ts,{},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/login-reset/index.tsx",lineNumber:40,columnNumber:31},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/pages/login-reset/index.tsx",lineNumber:20,columnNumber:5},this)}export{Qs as default};
