import{j as e,b as s}from"./index-BAjkLHRS.js";import{r,R as W}from"./index-Djf8kdDz.js";import{o as Q,q as Y,a as Z,N as ee,R as se,s as te,t as re}from"./react-spring-web.esm-BXduOQz-.js";import{E as oe}from"./ErrorPc-DHxd78Wz.js";import{M as p}from"./Meter-iHpCMIYU.js";/* empty css                      */import{u as ie}from"./useTranslation-Cclpl_OC.js";import"./index-BcQ2dhrg.js";import"./index-CCqWUn_M.js";import"./throttle-BPCfK1uX.js";import"./_baseIsEqual-8OBVMFu7.js";import"./iframe-fNLlJobk.js";import"../sb-preview/runtime.js";/* empty css              *//* empty css                         */const M=W.createRef();function xe(){const d=Q(),{t}=ie(),{search:k}=Y(),n=new URLSearchParams(k).get("reference"),g=Z(),{recaptchaInvisiblePublicKey:D,recaptchaEnabled:N,urlMobile:w,isTechnicalError:V}=window.tsme_data,[z,B]=r.useState(""),[P,I]=r.useState(""),[f,b]=r.useState(""),[j,v]=r.useState(""),[l,m]=r.useState(!0),[u,x]=r.useState(!1),[h,S]=r.useState(!1),[A,E]=r.useState(!0),[R,T]=r.useState(!1),[L,_]=r.useState(!1),[O,U]=r.useState(!0),[H,$]=r.useState(!1),y=n!==null&&n!=="",[X,c]=r.useState(!y),[q,F]=r.useState(t("photoMeter.securityCheck.technicalError"));navigator.userAgent.match(/Android/i)&&w&&window.location.replace(w),r.useEffect(()=>{y&&p.getMailAndPhone(n).then(({isError:o,anonymEmail:i,anonymCellPhone:a})=>{o&&c(!0),i!=="NO_MAIL"?(B(i),x(!0)):(x(!1),m(!1)),a!=="NO_CELLPHONE"?(I(a),S(!0)):S(!1),U(!1)}).catch(()=>{c(!0)})},[]);const G=({target:o})=>{b(o.value),v("");const i=te.test(o.value);T(!i),E(!i)},J=({target:o})=>{v(o.value),b("");const a=/^(?:(?:\+|00)33[\s.-]{0,3}(?:\(0\)[\s.-]{0,3})?|0)[1-9](?:(?:[\s.-]?\d{2}){4}|\d{2}(?:[\s.-]?\d{3}){2})$/.test(o.value);_(!a),E(!a)},K=o=>{o.preventDefault(),N?M.current.execute():C()};function C(){$(!0);const o=n;p.nextStepAction(o,f,j).then(i=>{i.code===1?p.generateJwToken(o).then(a=>{a.response.isError?c(!0):g.push(re.PHOTO_COUNTER_VALIDATION.replace(":reference",n))}).catch(()=>{c(!0)}):i.code===0&&(F(t("photoMeter.securityCheck.errorAddress")),c(!0))}).catch(()=>{c(!0)})}return X?e.jsxDEV(oe,{message:q,indiceError:0,titleError:"Information"},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:150,columnNumber:7},this):V?e.jsxDEV("div",{className:"home-index",children:e.jsxDEV("div",{className:"container global-container mb-2 mt-4 pb-2",children:e.jsxDEV("div",{className:`col-12 col-md-10 m-auto py-5 ${d?"pt-3":""}`,children:e.jsxDEV(s.SzBox,{className:"d-flex flex-column col-12",children:e.jsxDEV(s.SzAlert,{variant:"info",transparent:!0,children:t("photoMeter.securityCheck.technicalError")},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:164,columnNumber:15},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:163,columnNumber:13},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:158,columnNumber:11},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:157,columnNumber:9},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:156,columnNumber:7},this):e.jsxDEV(e.Fragment,{children:e.jsxDEV("div",{className:"home-index",children:e.jsxDEV("div",{className:"container global-container mb-2 mt-4 pb-2",children:e.jsxDEV("div",{className:`col-12 col-md-10 m-auto py-5 ${d?"pt-3":""}`,children:[e.jsxDEV(s.SzBox,{className:"d-flex flex-column col-12",children:e.jsxDEV(s.SzAlert,{variant:"info",transparent:!0,children:t("photoMeter.securityCheck.description")},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:184,columnNumber:15},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:183,columnNumber:13},this),e.jsxDEV(s.SzBox,{className:"container container-fluid mt-3",id:"form-global",children:e.jsxDEV("form",{id:"pc_pre_check_form",action:ee,method:"get",noValidate:"novalidate",onSubmit:K,children:[O&&e.jsxDEV("div",{className:"text-center",children:e.jsxDEV(s.SzSpinner,{},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:199,columnNumber:21},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:198,columnNumber:19},this),l&&u&&e.jsxDEV(s.SzBox,{className:"sds-container mt-2 bloc-w-email border new-rectangle",children:[e.jsxDEV(s.SzBox,{className:"sds-container mb-3",children:e.jsxDEV(s.SzTypographie,{variant:"caption",weight:"light",children:t("photoMeter.securityCheck.email.description")},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:205,columnNumber:23},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:204,columnNumber:21},this),e.jsxDEV(s.SzInput,{className:"col-md-8 input-security-mail",name:"email",value:f,onChange:G,label:t("photoMeter.securityCheck.email.description"),placeholder:t("photoMeter.securityCheck.email.placeholder")},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:209,columnNumber:21},this),R&&e.jsxDEV(s.SzAlert,{className:"col-md-8",variant:"danger",children:t("photoMeter.securityCheck.email.error")},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:220,columnNumber:23},this),e.jsxDEV(s.SzBox,{className:"sds-container mb-3",children:e.jsxDEV(s.SzTypographie,{weight:"bold",children:z},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:225,columnNumber:23},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:224,columnNumber:21},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:203,columnNumber:19},this),!l&&h&&u&&e.jsxDEV(s.SzBox,{children:e.jsxDEV("button",{className:"col-md-12 border border-light bg-light text-left font-weight-light email-confirm-button",type:"button",onClick:()=>m(!0),children:t("photoMeter.securityCheck.showBlockMail")},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:232,columnNumber:21},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:231,columnNumber:19},this),!l&&h&&e.jsxDEV(s.SzBox,{className:"sds-container mt-2 bloc-cell-phone border new-rectangle",children:[e.jsxDEV(s.SzBox,{className:"sds-container mb-3",children:e.jsxDEV(s.SzTypographie,{variant:"caption",weight:"light",children:t("photoMeter.securityCheck.phone.description")},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:245,columnNumber:23},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:244,columnNumber:21},this),e.jsxDEV(s.SzInput,{className:"col-md-8 input-security-mail",name:"cellphone",value:j,onChange:J,label:t("photoMeter.securityCheck.phone.label"),placeholder:t("photoMeter.securityCheck.phone.placeholder")},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:249,columnNumber:21},this),L&&e.jsxDEV(s.SzAlert,{className:"col-md-8",variant:"danger",children:t("photoMeter.securityCheck.phone.error")},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:260,columnNumber:23},this),e.jsxDEV("span",{children:e.jsxDEV(s.SzTypographie,{weight:"bold",children:P},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:265,columnNumber:23},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:264,columnNumber:21},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:243,columnNumber:19},this),l&&u&&h&&e.jsxDEV(s.SzBox,{children:e.jsxDEV("button",{className:"col-md-12 border border-light bg-light text-left font-weight-light mobile-confirm-button",type:"button",onClick:()=>m(!1),children:t("photoMeter.securityCheck.showBlockPhone")},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:274,columnNumber:21},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:273,columnNumber:19},this),e.jsxDEV(s.SzInput,{name:"fullRef",type:"hidden",value:n},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:284,columnNumber:17},this),N&&e.jsxDEV(se,{ref:M,size:"invisible",sitekey:D,onChange:C,badge:"bottomleft"},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:287,columnNumber:19},this),e.jsxDEV(s.SzBox,{className:"mt-3 mb-3",children:e.jsxDEV(s.SzButton,{variant:"contained",className:"mr-3 float-right",icon:"arrow-right-1",type:"submit",alignIcon:"right",isDisabled:A,loader:H,children:t("photoMeter.securityCheck.continue")},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:297,columnNumber:19},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:296,columnNumber:17},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:190,columnNumber:15},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:189,columnNumber:13},this)]},void 0,!0,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:178,columnNumber:11},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:177,columnNumber:9},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:176,columnNumber:7},this)},void 0,!1,{fileName:"/usr/var/www/assets/js/components/photoMeter/SecurityCheck.jsx",lineNumber:175,columnNumber:5},this)}export{xe as default};
