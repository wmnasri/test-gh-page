import{j as e,b as a}from"./index-BzhTyqaY.js";import{r as F}from"./index-0X8QCd_i.js";import{R}from"./recaptcha-wrapper-CLWKokWK.js";import"./main-BbuvrTKi.js";import{u as A,i as G,f as L,g as W,a as q}from"./useGetConsentQuery-BHaQcDt9.js";import{M as B}from"./index-E8Xemi00.js";import{u as T}from"./useTranslation-BYGhmYBG.js";import{u as H,C as J}from"./useValidateConsent-BWtaaZRo.js";import{u as X}from"./useSearchParams-D6beRwI4.js";import{S as Y}from"./index-R4VhrMC6.js";import{u as Z}from"./useResponsive-DQBhMvnf.js";import{C as $}from"./react-spring-web.esm-DsMzZgQq.js";import{C as Q}from"./AxiosInstance-BZZbXQ8a.js";import"./index-BoI371yk.js";import"./index-4p5aklhB.js";import"./throttle-C5YRRb_b.js";import"./_baseIsEqual-DwR-aJgz.js";import"./iframe-CrganuSH.js";import"../sb-preview/runtime.js";import"./nonIterableRest-CnCppAvF.js";import"./useQuery-DDRZMcvI.js";import"./formik.esm-DgjVmEdT.js";import"./useQueryObserver-BYynaL_B.js";import"./index-m5SwaE3w.js";/* empty css              *//* empty css                         */import"./useMutation-DnofRurj.js";const ee=({statusCode:i,isValidateConsent:m=!1,isKoConsent:r=!1,isEmbed:f=!1})=>{const{t:n}=T(),o=parseInt(i),l=!m&&!r&&(o===404||!o),c=o>=400&&o!==404;return e.jsxDEV("div",{className:"consent-message-container",children:e.jsxDEV("div",{className:"container",children:e.jsxDEV("div",{className:"block",children:[e.jsxDEV("div",{className:"message",children:[e.jsxDEV("div",{className:"icon",children:[m&&e.jsxDEV(a.SzIcon,{variant:"bold",icon:"check-circle-1"},void 0,!1,{fileName:"/usr/var/www/assets/js/components/consent/message/index.jsx",lineNumber:26,columnNumber:17},void 0),(c||l)&&e.jsxDEV(a.SzIcon,{variant:"bold",icon:"remove"},void 0,!1,{fileName:"/usr/var/www/assets/js/components/consent/message/index.jsx",lineNumber:29,columnNumber:17},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/components/consent/message/index.jsx",lineNumber:24,columnNumber:13},void 0),e.jsxDEV("div",{className:"content",children:[m&&e.jsxDEV(a.SzTypographie,{className:"title",children:n("consent.confirmation.success.title")},void 0,!1,{fileName:"/usr/var/www/assets/js/components/consent/message/index.jsx",lineNumber:34,columnNumber:17},void 0),r&&(f?e.jsxDEV(a.SzTypographie,{className:"title",children:n("consent.ko_content")},void 0,!1,{fileName:"/usr/var/www/assets/js/components/consent/message/index.jsx",lineNumber:44,columnNumber:19},void 0):e.jsxDEV(a.SzTypographie,{className:"title",children:n("consent.confirmation.ko_content")},void 0,!1,{fileName:"/usr/var/www/assets/js/components/consent/message/index.jsx",lineNumber:40,columnNumber:19},void 0)),l&&e.jsxDEV(a.SzTypographie,{className:"title",children:e.jsxDEV(B,{content:n("consent.confirmation.404.title")},void 0,!1,{fileName:"/usr/var/www/assets/js/components/consent/message/index.jsx",lineNumber:50,columnNumber:19},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/components/consent/message/index.jsx",lineNumber:49,columnNumber:17},void 0),c&&e.jsxDEV(e.Fragment,{children:[e.jsxDEV(a.SzTypographie,{className:"title",children:n("consent.confirmation.500.title")},void 0,!1,{fileName:"/usr/var/www/assets/js/components/consent/message/index.jsx",lineNumber:55,columnNumber:19},void 0),e.jsxDEV(a.SzTypographie,{children:n("consent.confirmation.500.description")},void 0,!1,{fileName:"/usr/var/www/assets/js/components/consent/message/index.jsx",lineNumber:58,columnNumber:19},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/components/consent/message/index.jsx",lineNumber:54,columnNumber:17},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/components/consent/message/index.jsx",lineNumber:32,columnNumber:13},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/components/consent/message/index.jsx",lineNumber:23,columnNumber:11},void 0),e.jsxDEV("div",{className:"line"},void 0,!1,{fileName:"/usr/var/www/assets/js/components/consent/message/index.jsx",lineNumber:65,columnNumber:11},void 0)]},void 0,!0,{fileName:"/usr/var/www/assets/js/components/consent/message/index.jsx",lineNumber:22,columnNumber:9},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/components/consent/message/index.jsx",lineNumber:21,columnNumber:7},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/components/consent/message/index.jsx",lineNumber:20,columnNumber:5},void 0)},ke=()=>{var j,b,g,v,h,E,V,D,S;const i=F.useRef(null),{t:m}=T(),r=X(),f=Z(),n=r.get("reference")||null,o="landingPage",{recaptchaInvisiblePublicKey:l,recaptchaEnabled:c}=window.tsme_data,N={codeParcours:o,reference:n,typeUsage:r.get("type_usage")||null,codeUsage:r.get("code_usage")||null},{data:t,isError:x,...d}=A({params:N,options:{enabled:n!==null}}),w=((j=t==null?void 0:t.data)==null?void 0:j.message)===Q.KO_CONSENT,{isError:C,...s}=H(),O=((g=(b=s==null?void 0:s.data)==null?void 0:b.data)==null?void 0:g.message)==="OK",M=w||x||O||C,P=async p=>{var y,k,z;const u=q({params:p,reference:n,codeParcours:o}),U=((y=Object.keys(u))==null?void 0:y.length)>0,K=((k=u==null?void 0:u.codeUsages)==null?void 0:k.length)>0;c&&(N["g-recaptcha-response"]=await((z=i==null?void 0:i.current)==null?void 0:z.executeAsync())),U&&K&&s.mutate(u)},_=G({translate:m,data:L(((v=t==null?void 0:t.data)==null?void 0:v.typesUsages)||{})}),I=W({consents:_});if(d.isLoading)return e.jsxDEV($,{children:e.jsxDEV(Y,{width:f?"100%":744,height:300,className:"d-flex mb-4 mx-auto"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/consent/index.tsx",lineNumber:91,columnNumber:9},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/consent/index.tsx",lineNumber:90,columnNumber:7},void 0);if(M||!n||x){const p=((h=s==null?void 0:s.data)==null?void 0:h.status)||((V=(E=s==null?void 0:s.error)==null?void 0:E.response)==null?void 0:V.status)||((S=(D=d==null?void 0:d.error)==null?void 0:D.response)==null?void 0:S.status)||null;return e.jsxDEV(ee,{statusCode:p,isValidateConsent:s==null?void 0:s.isSuccess,isKoConsent:w},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/consent/index.tsx",lineNumber:108,columnNumber:7},void 0)}return e.jsxDEV("div",{className:"consents-page tsme-container",children:e.jsxDEV(J,{type:"page",dynamicValidationSchema:I,onSubmit:P,children:c&&e.jsxDEV(R,{ref:i,size:"invisible",sitekey:l,badge:"bottomleft"},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/consent/index.tsx",lineNumber:124,columnNumber:11},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/consent/index.tsx",lineNumber:118,columnNumber:7},void 0)},void 0,!1,{fileName:"/usr/var/www/assets/js/pages/consent/index.tsx",lineNumber:117,columnNumber:5},void 0)};export{ke as default};
